<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Merlin" />



<meta name="description" content="卖油翁的故事告诉我们，熟能生巧；唯手熟尔。(主讲人是 golang 方面的大师)">
<meta name="keywords" content="golang">
<meta property="og:type" content="article">
<meta property="og:title" content="Golang: Here We Go(5.孰能生巧-Oreilly大师讲解&amp;再练习)">
<meta property="og:url" content="http://www.merlinblog.site/posts/94df7563/index.html">
<meta property="og:site_name" content="梅林日志">
<meta property="og:description" content="卖油翁的故事告诉我们，熟能生巧；唯手熟尔。(主讲人是 golang 方面的大师)">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://www.commoncommonheart.com/wp-content/uploads/2018/03/gogogo1.jpg">
<meta property="og:image" content="http://www.commoncommonheart.com/wp-content/uploads/2018/03/unit0.jpg">
<meta property="og:image" content="http://www.commoncommonheart.com/wp-content/uploads/2018/03/unit1.jpg">
<meta property="og:image" content="http://www.commoncommonheart.com/wp-content/uploads/2018/03/unit2.jpg">
<meta property="og:image" content="http://www.commoncommonheart.com/wp-content/uploads/2018/03/unit3.jpg">
<meta property="og:image" content="http://www.commoncommonheart.com/wp-content/uploads/2018/03/golangmaster1.jpg">
<meta property="og:updated_time" content="2018-04-12T06:55:17.650Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Golang: Here We Go(5.孰能生巧-Oreilly大师讲解&amp;再练习)">
<meta name="twitter:description" content="卖油翁的故事告诉我们，熟能生巧；唯手熟尔。(主讲人是 golang 方面的大师)">
<meta name="twitter:image" content="http://www.commoncommonheart.com/wp-content/uploads/2018/03/gogogo1.jpg">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="梅林日志" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.gif">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/red/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Golang: Here We Go(5.孰能生巧-Oreilly大师讲解&amp;再练习) | 梅林日志</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: false
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/mine.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Merlin</a></h1>
        </hgroup>

        
        <p class="header-subtitle">云卷云舒，平常心态</p>
        

        


        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">[归档]</a></li>
                        
                            <li><a href="/works/">小作品</a></li>
                        
                            <li><a href="/tags/">[标签]</a></li>
                        
                            <li><a href="/about/">关于</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" href="https://github.com/WizardMerlin" title="GitHub"></a>
                            
                                <a class="fa 豆瓣" href="https://www.douban.com/people/170414854/" title="豆瓣"></a>
                            
                                <a class="fa Email" href="mailto:&#119;&#105;&#122;&#97;&#114;&#100;&#109;&#101;&#114;&#108;&#105;&#110;&#57;&#52;&#53;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;" title="Email"></a>
                            
                                <a class="fa QQ" href="tencent://message/?Menu=yes&uin=3076407405" title="QQ"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">极简.</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Merlin</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/mine.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Merlin</a></h1>
            </hgroup>
            
            <p class="header-subtitle">云卷云舒，平常心态</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">[归档]</a></li>
                
                    <li><a href="/works/">小作品</a></li>
                
                    <li><a href="/tags/">[标签]</a></li>
                
                    <li><a href="/about/">关于</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/WizardMerlin" title="GitHub"></a>
                            
                                <a class="fa 豆瓣" target="_blank" href="https://www.douban.com/people/170414854/" title="豆瓣"></a>
                            
                                <a class="fa Email" target="_blank" href="mailto:&#119;&#105;&#122;&#97;&#114;&#100;&#109;&#101;&#114;&#108;&#105;&#110;&#57;&#52;&#53;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;" title="Email"></a>
                            
                                <a class="fa QQ" target="_blank" href="tencent://message/?Menu=yes&uin=3076407405" title="QQ"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-high-go" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/94df7563/" class="article-date">
      <time datetime="2018-03-11T04:23:24.000Z" itemprop="datePublished">2018-03-11</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Golang: Here We Go(5.孰能生巧-Oreilly大师讲解&amp;再练习)
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/GoGolang专栏/">GoGolang专栏</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>卖油翁的故事告诉我们，熟能生巧；唯手熟尔。(主讲人是 golang 方面的大师)<br><a id="more"></a></p>
<blockquote>
<p>曾表示过：先空杯心态，然后认真学习别人的长处，取长补短才能更进一步。</p>
<blockquote>
<p>现在我要说，有先驱&amp;大师指导，跟你自己看书底下练习效果相差非常多</p>
</blockquote>
</blockquote>
<p><strong>全部跟着3位大师重新走了一遍，发现他所说不假；一本书&amp;教程，Golang所有内容概括到了</strong>。</p>
<blockquote>
<p>以前那篇文章<a href="www.merlinblog.site/posts/d3fb236/">《Golang代码走廊》</a>只是掌握Go语法，这里导师教你的不仅仅是语法，是Golang的使用思维</p>
</blockquote>
<p><img src="http://www.commoncommonheart.com/wp-content/uploads/2018/03/gogogo1.jpg" alt=" "></p>
<ul>
<li>代码已经上传 Github 库: <a href="https://github.com/WizardMerlin/gopher" target="_blank" rel="noopener">《gopher宝库》</a>。</li>
<li>视频地址: <a href="http://shop.oreilly.com/product/0636920035305.do" target="_blank" rel="noopener">《oreilly press》</a>，视频是全英文。</li>
</ul>
<p>如果你去听大师讲，大概视频全长 5个半小时，如果还要练习，那么直接 * 2；看我这篇文章，大概1个小时吧。<br>我看着这套教程的时候，其实语法已经非常熟悉了(从C++转到Go，并决心以后多用Go，少用C++)，但是看完之后还是收获很多。下面是我的笔记，认真记录了练习的过程————希望可以帮到你。（有基础的话，懂的可以不必细看，直接快速带过去）</p>
<p>btw: 他讲解基础语法的时候，顺带把 golang 的标准库一起讲完了。。。(我专门把标准库拿出来写)</p>
<blockquote>
<p>大师口气很大，说听他讲完后，你基本就能写大型项目，并且已经完全掌握了语言特性。(有意思)</p>
</blockquote>
<p>忘了说，这一次和 <code>代码走廊</code> 那一次非常不同，那一次是非常认真，这里只是查漏补缺。</p>
<hr>
<h2 id="Hello"><a href="#Hello" class="headerlink" title="Hello"></a>Hello</h2><p>文件名和包名无关，大写开头函数是可导出的函数(被外部引用)，字符串采用 uft8 编码而不是ascii码。<br>函数名(被调用的函数)也是 uft8编码。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Printf(<span class="string">"Hello, world\n"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="目录讲解"><a href="#目录讲解" class="headerlink" title="目录讲解"></a>目录讲解</h2><p>gopath 是 go 语言执行 &amp; 寻找源码的依据(而不是goroot)。<br>多个项目依赖时，记得要安装 <code>go install</code>，而不是直接 <code>go run</code>。</p>
<p>关于项目依赖这部分，可以看我前面的文章。</p>
<blockquote>
<p>Go提倡一个项目一个GOPATH，但是也可以只使用一个GOPATH</p>
<blockquote>
<p>但是多项目依赖时要记得先安装，并且 import 的路径始终是相对于 GOPATH/src而言的</p>
</blockquote>
</blockquote>
<p><code>go fmt</code>，前大括号必须在上一行。(IDE 可以自己整理环境)</p>
<h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2><p>本机文档可以查看 <code>godoc 包名 关键字</code>，例如 <code>godoc fmt Printf</code>。</p>
<p>在线的可以查看官网 <a href="http://www.golang.org" target="_blank" rel="noopener">《golang.org》</a>，同时可以查看源码。</p>
<blockquote>
<p>直接用 IDE 吧，直接查看源码.</p>
</blockquote>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>Variables, Simple Types。</p>
<p><code>:=</code>相当于声明和定义，有点儿像动态语言。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> message <span class="keyword">string</span></span><br><span class="line">  message = <span class="string">"hello, world"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//message := "hello, world"</span></span><br><span class="line"></span><br><span class="line">  fmt.Println(message)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>const 常量，同时可以按组定义 (一次定义多个)。小写定义的变量，包外不可见。<br>自动重复上面的规则上一个枚举定义的规则:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">  answer1 = <span class="literal">iota</span>*<span class="number">2</span></span><br><span class="line">  answer2</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(answer1, answer2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>普通变量的省略写法:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">//nine := 9</span></span><br><span class="line">  nine := <span class="keyword">uint64</span>(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">  fmt.Printf(<span class="string">"value: %d\n"</span>, nine)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><p>把它当做 slice/容器操作，或者借助 <code>strings</code> 包工具。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  str := <span class="string">"hello,world,hellowold"</span></span><br><span class="line"></span><br><span class="line">  substr1 := str[<span class="number">1</span>:]</span><br><span class="line">  substr2 := str[<span class="number">1</span>:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">  fmt.Println(substr1)</span><br><span class="line">  fmt.Println(substr2)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i, r := <span class="keyword">range</span> str &#123;</span><br><span class="line">    fmt.Println(i, <span class="string">" : "</span>, r)</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>并且单引号括起来的不转义，尽量使用双引号。</p>
<h2 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h2><p>即便是 fmt.Println 其实也是多返回值的函数，一般可以用 inline if 去检查错误。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> numbers, errors := fmt.Println(<span class="string">"Hello"</span>); errors != <span class="literal">nil</span> &#123;</span><br><span class="line">    os.Exit(<span class="number">1</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%d bytes charactors printed.\n"</span>, numbers)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是注意 inline 条件判断定义的变量，作用域只在 if-else 块儿。</p>
<h2 id="switch语句"><a href="#switch语句" class="headerlink" title="switch语句"></a>switch语句</h2><p>条件太多了的情况，switch 判断起来可以直接不写变量；默认执行一路之后 break 出去。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  n, err := fmt.Println(<span class="string">"HelloWorld"</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> &#123; <span class="comment">//switch这里不写枚举，下面case进行条件判断</span></span><br><span class="line">  <span class="keyword">case</span> err != <span class="literal">nil</span>:</span><br><span class="line">    os.Exit(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">case</span> n == <span class="number">0</span>:</span><br><span class="line">    fmt.Println(<span class="string">"0 bytes output"</span>)</span><br><span class="line">  <span class="keyword">case</span> n != <span class="number">11</span>:  <span class="comment">/*including \n*/</span></span><br><span class="line">    fmt.Println(<span class="string">"wrong number of characters"</span>)</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">"ok;"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Printf(<span class="string">"\n"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>fallthrough 可以不停执行下去，不过没有必要。因为 case 里面可以写多个枚举:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> value &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'a'</span>,<span class="string">'e'</span>,<span class="string">'i'</span>,<span class="string">'o'</span>,<span class="string">'u'</span>: vowels++</span><br><span class="line">  <span class="keyword">default</span>: cons++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h2><p>没有while循环，但是多种for循环解决所有的问题。</p>
<p>死循环</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">  <span class="comment">//do sth.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>带有判断的循环:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> counter <span class="keyword">int</span></span><br><span class="line">counter = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> counter &lt; <span class="number">10</span> &#123;</span><br><span class="line">  <span class="comment">//do sth</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>普通循环:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> counter := <span class="number">0</span>; counter &lt;<span class="number">10</span>; counter++ &#123;</span><br><span class="line">  <span class="comment">//do sth</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第一部分和第三部分可以同时赋值多个变量，simultaneously。</p>
<h2 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h2><p>简单定义: (有参数，没有返回值)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printer</span><span class="params">(msg <span class="keyword">string</span>, whom <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">  fmt.Print(<span class="string">"%s 2 %s\n"</span>, msg, whom)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//简写</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printer</span><span class="params">(msg, whom <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">  fmt.Print(<span class="string">"%s 2 %s\n"</span>, msg, whom)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有返回值: (单个或者多个)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printer</span><span class="params">(msg <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">  _, err := fmt.Println(msg)</span><br><span class="line">  <span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以在函数内部定义一个 defer 处理错误，比如文件操作:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fileOperat</span><span class="params">()</span> <span class="title">error</span></span> &#123;</span><br><span class="line">  f, err := os.Create(<span class="string">"re.log"</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> err</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">defer</span> f.Close()</span><br><span class="line">  f.Write(msg)</span><br><span class="line">  <span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>返回值也可以定义实例，只不过不返回内容了: (多返回值，则指定多个返回值实例)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printer</span><span class="params">(msg <span class="keyword">string</span>)</span> <span class="params">(e error)</span></span> &#123;</span><br><span class="line">  _, e := fmt.Println(msg)</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>defer 的执行顺序和定义顺序相反:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  printer(<span class="string">"mine"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printer</span><span class="params">(msg <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">  <span class="keyword">defer</span> fmt.Println(<span class="string">"over"</span>)</span><br><span class="line">  <span class="keyword">defer</span> fmt.Print(<span class="string">"?\n"</span>);</span><br><span class="line">  _, err := fmt.Println(msg)</span><br><span class="line">  <span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="不定参数"><a href="#不定参数" class="headerlink" title="不定参数"></a>不定参数</h2><p>和其他语言一样，<code>msgs...string</code>，然后当做 slice 去遍历操作。</p>
<p>放在最后一个参数位置。</p>
<h2 id="数组和切片"><a href="#数组和切片" class="headerlink" title="数组和切片"></a>数组和切片</h2><p>用切片 slice 明显多过数组，不仅仅是因为速度，还因为切片更加灵活可变。</p>
<p>数组:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">//words := [...]string&#123;"the", "world","is","ours."&#125;</span></span><br><span class="line">  words := [<span class="number">4</span>]<span class="keyword">string</span>&#123;<span class="string">"the"</span>, <span class="string">"world"</span>,<span class="string">"is"</span>,<span class="string">"ours."</span>&#125;</span><br><span class="line">  <span class="comment">//words := []string&#123;"the", "world","is","ours."&#125;</span></span><br><span class="line">  fmt.Print(words)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>除非你默认指定用传递指针，否则数组默认按照值拷贝传递。(修改的是副本)<br>函数参数 <code>s []string</code> 实际上传递的是 slice。</p>
<blockquote>
<p>slice 可以看做底层数组的一个 window 窗口: 从起始位置偏移，然后取N个元素</p>
</blockquote>
<p>并且 slice 默认传递的是引用，修改的直接就是底层数组. (没有扩容的情况下)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeStr</span><span class="params">(strs []<span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> _, value := <span class="keyword">range</span> strs &#123;</span><br><span class="line">    fmt.Print(value)</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println()</span><br><span class="line">  strs[<span class="number">0</span>] = <span class="string">"ur"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  words := []<span class="keyword">string</span>&#123;<span class="string">"the"</span>, <span class="string">"world"</span>,<span class="string">"is"</span>,<span class="string">"ours."</span>&#125;</span><br><span class="line">  changeStr(words)</span><br><span class="line">  changeStr(words)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>slice 也可以进行 <code>[start:len]</code> 截取操作等。<br>同时可以使用 <code>make</code> 进行初始化，指定长度，容量capacity。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">words := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="number">4</span>, <span class="number">8</span>) <span class="comment">//初始元素个数 4 个元素，容量为8</span></span><br><span class="line">words[<span class="number">0</span>] = <span class="string">"xxx"</span></span><br><span class="line">...</span><br><span class="line">words[<span class="number">3</span>] = <span class="string">"xxx"</span></span><br></pre></td></tr></table></figure>
<p>这里有用的全局函数是 <code>len()</code>, <code>cap()</code>, <code>append()</code>；容量不足时会拷贝 &amp; 翻倍。</p>
<blockquote>
<p>所以使用 append 之类的操作，类似的操作要小心。</p>
</blockquote>
<p>越界操作会保运行时异常。(golang直接报错，终止程序)</p>
<p>slice默认是引用传递，也体现在赋值上；直接赋值(包括截取操作)，其实是共享同一份底层数组。<br><code>拷贝副本</code> 可以使用 <code>copy()</code> 函数 <code>copy(newWords, oldWords)</code>。</p>
<h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><p>字典或者键值对。</p>
<p>动态分配：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dayMonths := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">  dayMonths[<span class="string">"Jan"</span>] = <span class="number">31</span></span><br><span class="line">  dayMonths[<span class="string">"Feb"</span>] = <span class="number">28</span></span><br></pre></td></tr></table></figure>
<p>或者栈上建立 map:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dayMonths := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span> &#123;</span><br><span class="line">  <span class="string">"Jan"</span>: <span class="number">31</span>,</span><br><span class="line">  <span class="string">"Feb"</span>: <span class="number">28</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不存在的元素会拿到一个 zero value，而不会报异常。当然也可以使用 ok pattern:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  dayMonths := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">  dayMonths[<span class="string">"Jan"</span>] = <span class="number">31</span></span><br><span class="line">  dayMonths[<span class="string">"Feb"</span>] = <span class="number">28</span></span><br><span class="line"></span><br><span class="line">  days, ok := dayMonths[<span class="string">"Jans"</span>] </span><br><span class="line">  <span class="keyword">if</span> !ok &#123;</span><br><span class="line">    fmt.Println(<span class="string">"Can't get days for Jan"</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%d\n"</span>, days)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>遍历，以 key-value range 的形式，但是不是插入的顺序了:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">for</span> month, day := <span class="keyword">range</span> dayMonths &#123;</span><br><span class="line">    fmt.Println(month, <span class="string">"has "</span>, day, <span class="string">"days"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用全局函数 delete() 删除具体的 key-value:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">delete</span>(dayMonths, <span class="string">"Feb"</span>)</span><br></pre></td></tr></table></figure>
<p>不过不存在 &amp;&amp; 删除多次，不会报错(删除不生效)。(delete 内部做了错误检查)</p>
<h2 id="byte切片"><a href="#byte切片" class="headerlink" title="byte切片"></a>byte切片</h2><p>io处理的时候，字节slice用的非常多。(而不是直接写 string)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *File)</span> <span class="title">Write</span><span class="params">(b []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>
<p>并且在编译时就会对转换类型进行检查:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  f, err := os.Open(<span class="string">"te.txt"</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"Open File Error"</span>)</span><br><span class="line">    os.Exit(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">defer</span> f.Close()</span><br><span class="line"></span><br><span class="line">  bytes := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">128</span>)</span><br><span class="line">  n, err := f.Read(bytes)</span><br><span class="line">  str := <span class="keyword">string</span>(bytes) <span class="comment">//编译时检查</span></span><br><span class="line">  fmt.Println(<span class="string">"read "</span>, str, <span class="string">" : "</span>, n, <span class="string">" bytes"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>直接打印 byte 的话得到的是数字。string 转换成 byte :</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str := <span class="string">"test"</span></span><br><span class="line">f.Write([]<span class="keyword">byte</span>(str))</span><br></pre></td></tr></table></figure>
<h2 id="错误异常"><a href="#错误异常" class="headerlink" title="错误异常"></a>错误异常</h2><p>这里大师讲了，这样一段话:</p>
<blockquote>
<p>函数返回 error 给主调函数，然后主调函数处理异常。</p>
<blockquote>
<p>another way called panic and recover, <strong>but it extremly rarely used</strong>.</p>
</blockquote>
</blockquote>
<p>Go 的哲学是 handling errors returned by funcs。(而不是抛出异常 &amp; 异常处理那一套)</p>
<ul>
<li>使用 fmt 本身提示</li>
<li>使用 errors 包</li>
</ul>
<p>使用 fmt 的情况，大致类似如下:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printer</span><span class="params">(msg <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> msg == <span class="string">""</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fmt.Errorf(<span class="string">"Unwilling to print an empty string"</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _, err := fmt.Printf(<span class="string">"%s\n"</span>, msg)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> err := printer(<span class="string">""</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"printer failed: %s\n"</span>, err)</span><br><span class="line">  &#125;</span><br><span class="line">  os.Exit(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>errors 包的情况:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"errors"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">  errorEmptyString = errors.New(<span class="string">"Unwilling to print an empty string"</span>);</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printer</span><span class="params">(msg <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> msg == <span class="string">""</span> &#123;</span><br><span class="line">    <span class="comment">//return fmt.Errorf("Unwilling to print an empty string")</span></span><br><span class="line">    <span class="keyword">return</span> errorEmptyString</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _, err := fmt.Printf(<span class="string">"%s\n"</span>, msg)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> err := printer(<span class="string">""</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> err == errorEmptyString &#123;</span><br><span class="line">      fmt.Printf(<span class="string">"printer failed: %s\n"</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  os.Exit(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后，他强调一般情况下都返回 error 即可，除非造成了不可挽回的、致使程序终止的情况才使用 panic。</p>
<h2 id="协程-amp-chan"><a href="#协程-amp-chan" class="headerlink" title="协程&amp;chan"></a>协程&amp;chan</h2><p>chan 让 goroutine 具备互相通信的能力。</p>
<p>简单的案例 (不设置 chan 的大小，for 循环不断发送):</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">emit</span><span class="params">(c <span class="keyword">chan</span> <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">  words := []<span class="keyword">string</span> &#123;<span class="string">"the"</span>, <span class="string">"quick"</span>, <span class="string">"brown"</span>, <span class="string">"fox"</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> _, word := <span class="keyword">range</span> words &#123;</span><br><span class="line">    c &lt;- word <span class="comment">//循环写入 chan</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">close</span>(c)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wordChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>) <span class="comment">//不指定队列大小，默认不使用队列</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">go</span> emit(wordChan)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> word := <span class="keyword">range</span> wordChan &#123;<span class="comment">//事先并不知知道要对方要写几个</span></span><br><span class="line">    fmt.Printf(<span class="string">"%s "</span>, word)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//word := &lt;- wordChan  //这样只能拿到一个, 然后程序结束</span></span><br><span class="line"></span><br><span class="line">  fmt.Print(<span class="string">"\n"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上从 chan 拿到内容的时候，可以检查一下是否关闭了:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">word, isOpen := &lt;- wordChan  <span class="comment">//false表示已经关闭</span></span><br></pre></td></tr></table></figure>
<p>如果发送完毕，不关闭 chan， 那么就会造成死锁， main 这里一直等待。</p>
<p><strong>对于接收无所谓，但是对于发送，一定要注意关闭 chan</strong>。</p>
<h2 id="select语句"><a href="#select语句" class="headerlink" title="select语句"></a>select语句</h2><p>有 <code>多个 chan</code> 读写的时候，用 select 管理&amp;监听读写就很方便了。<br>书写语法有点儿像 switch，需要外层 for 循环支持:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">emit</span><span class="params">(wordChan <span class="keyword">chan</span> <span class="keyword">string</span>, done <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line">  words := []<span class="keyword">string</span>&#123;<span class="string">"the"</span>,<span class="string">"quick"</span>,<span class="string">"brown"</span>,<span class="string">"fox"</span>&#125;</span><br><span class="line"></span><br><span class="line">  i := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> wordChan &lt;- words[i]: <span class="comment">//写出去</span></span><br><span class="line">      i++</span><br><span class="line">      <span class="keyword">if</span> i == <span class="built_in">len</span>(words) &#123;</span><br><span class="line">        i = <span class="number">0</span> <span class="comment">//再重头开始</span></span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">case</span> &lt;-done: <span class="comment">//收到停止的信息，停止接收</span></span><br><span class="line">      fmt.Println(<span class="string">"Got done"</span>)</span><br><span class="line">      <span class="built_in">close</span>(done)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wordChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line">  doneChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">go</span> emit(wordChan, doneChan)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i:= <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%s\n"</span>, &lt;-wordChan) <span class="comment">//收取对方写入的内容，10次</span></span><br><span class="line">  &#125;</span><br><span class="line">  doneChan &lt;- <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到 select 里面会对不同的 chan 的读写进行判断。<br>(而不能用 switch，因为select 才能监控 chan 的 io 读写)</p>
<p>如果子 routines 不关闭 chan，那么这里貌似也没有问题，因为主 routine 发送完毕就结束了，程序结束了。甚至可以在子 routine里面发送信息给主线程，然后主线程等着接收，它接收到了结束后再结束。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">emit</span><span class="params">(wordChan <span class="keyword">chan</span> <span class="keyword">string</span>, done <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line">  words := []<span class="keyword">string</span>&#123;<span class="string">"the"</span>,<span class="string">"quick"</span>,<span class="string">"brown"</span>,<span class="string">"fox"</span>&#125;</span><br><span class="line"></span><br><span class="line">  i := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> wordChan &lt;- words[i]: <span class="comment">//写出去</span></span><br><span class="line">      i++</span><br><span class="line">      <span class="keyword">if</span> i == <span class="built_in">len</span>(words) &#123;</span><br><span class="line">        i = <span class="number">0</span> <span class="comment">//再重头开始</span></span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">case</span> &lt;-done: <span class="comment">//收到停止的信息，停止接收</span></span><br><span class="line">      fmt.Println(<span class="string">"Got done"</span>)</span><br><span class="line">      <span class="built_in">close</span>(done)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wordChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line">  doneChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">go</span> emit(wordChan, doneChan)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i:= <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%s\n"</span>, &lt;-wordChan) <span class="comment">//收取对方写入的内容，10次</span></span><br><span class="line">  &#125;</span><br><span class="line">  doneChan &lt;- <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="chan读写超时"><a href="#chan读写超时" class="headerlink" title="chan读写超时"></a>chan读写超时</h2><p>如果我等对方，对方一直不发送怎么办？傻等？设置一个超时机制吧:</p>
<p>select 里面再加一个分支，为超时等待分支。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"time"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">emit</span><span class="params">(wordChan <span class="keyword">chan</span> <span class="keyword">string</span>, done <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line">  words := []<span class="keyword">string</span>&#123;<span class="string">"the"</span>,<span class="string">"quick"</span>,<span class="string">"brown"</span>,<span class="string">"fox"</span>&#125;</span><br><span class="line"></span><br><span class="line">  i := <span class="number">0</span></span><br><span class="line">  t := time.NewTimer(<span class="number">3</span> * time.Second) <span class="comment">//三秒后执行 timeout 分支</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">defer</span> <span class="built_in">close</span>(wordChan)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> wordChan &lt;- words[i]: <span class="comment">//写出去</span></span><br><span class="line">      i++</span><br><span class="line">      <span class="keyword">if</span> i == <span class="built_in">len</span>(words) &#123;</span><br><span class="line">        i = <span class="number">0</span> <span class="comment">//再重头开始</span></span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">case</span> &lt;-done: <span class="comment">//收到停止的信息，停止接收</span></span><br><span class="line">      fmt.Println(<span class="string">"Got done"</span>)</span><br><span class="line">      <span class="comment">//close(done)</span></span><br><span class="line">      done &lt;- <span class="literal">true</span></span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">case</span> &lt;-t.C:</span><br><span class="line">      fmt.Println(<span class="string">"tiemout"</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wordChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line">  doneChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">go</span> emit(wordChan, doneChan)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> word := <span class="keyword">range</span> wordChan &#123;</span><br><span class="line">    fmt.Println(word)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="传递chan"><a href="#传递chan" class="headerlink" title="传递chan"></a>传递chan</h2><p>如果 chan 传递的类型是 chan，那么就是 chan 中 chan了，一方往这个chan里面写，传递这个chan，然后另一方拿到这个 chan，再从chan里面读取内容。</p>
<p>传递 chan 是一种能力。</p>
<h2 id="多个协程实现线程池"><a href="#多个协程实现线程池" class="headerlink" title="多个协程实现线程池"></a>多个协程实现线程池</h2><p>获取网页长度:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"io/ioutil"</span></span><br><span class="line">  <span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getPage</span><span class="params">(url <span class="keyword">string</span>)</span><span class="params">(<span class="keyword">int</span>, error)</span></span> &#123; <span class="comment">//返回读取的长度</span></span><br><span class="line">  resp, err := http.Get(url)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>, err</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line">  body, err := ioutil.ReadAll(resp.Body)</span><br><span class="line">  <span class="keyword">if</span> err!= <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>, err</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">len</span>(body),<span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  url := <span class="string">"http://www.baidu.com/"</span></span><br><span class="line"></span><br><span class="line">  pageLen, err := getPage(url)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"Get Page Err"</span>)</span><br><span class="line">    os.Exit(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fmt.Printf(<span class="string">"%s is length %d\n"</span>, url, pageLen)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果要测试几个 url 可以遍历，像这样？</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"io/ioutil"</span></span><br><span class="line">  <span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getPage</span><span class="params">(url <span class="keyword">string</span>)</span><span class="params">(<span class="keyword">int</span>, error)</span></span> &#123; <span class="comment">//返回读取的长度</span></span><br><span class="line">  resp, err := http.Get(url)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>, err</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line">  body, err := ioutil.ReadAll(resp.Body)</span><br><span class="line">  <span class="keyword">if</span> err!= <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>, err</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">len</span>(body),<span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  urls := []<span class="keyword">string</span>&#123; <span class="string">"http://www.baidu.com/"</span>, <span class="string">"http://www.merlinblog.site/"</span>,</span><br><span class="line">     <span class="string">"http://www.commoncommonheart.com/"</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> _, url := <span class="keyword">range</span> urls &#123;</span><br><span class="line">    pageLen, err := getPage(url)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"Get Page Err"</span>)</span><br><span class="line">      os.Exit(<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Printf(<span class="string">"%s is length %d\n"</span>, url, pageLen)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行速度是很慢的，可以怎么改进呢？</p>
<blockquote>
<p>顺序 getUrl 可以改成多个协程进行任务，把具体数字回写给主线程</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"io/ioutil"</span></span><br><span class="line">  <span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getPage</span><span class="params">(url <span class="keyword">string</span>)</span><span class="params">(<span class="keyword">int</span>, error)</span></span> &#123; <span class="comment">//返回读取的长度</span></span><br><span class="line">  resp, err := http.Get(url)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>, err</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line">  body, err := ioutil.ReadAll(resp.Body)</span><br><span class="line">  <span class="keyword">if</span> err!= <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>, err</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">len</span>(body),<span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getter</span><span class="params">(url <span class="keyword">string</span>, size <span class="keyword">chan</span> <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">  pageLen, err := getPage(url)</span><br><span class="line">  <span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">    size &lt;- pageLen</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  urls := []<span class="keyword">string</span>&#123; <span class="string">"http://www.baidu.com/"</span>, <span class="string">"http://www.merlinblog.site/"</span>,</span><br><span class="line">     <span class="string">"http://www.commoncommonheart.com/"</span>&#125;</span><br><span class="line"></span><br><span class="line">  sizeChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> _, url := <span class="keyword">range</span> urls &#123;</span><br><span class="line">    <span class="keyword">go</span> getter(url, sizeChan)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//等待接收</span></span><br><span class="line">  <span class="keyword">for</span> i:=<span class="number">0</span>; i&lt;<span class="built_in">len</span>(urls); i++ &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%s is length %d\n"</span>, urls[i], &lt;-sizeChan)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同时开启去取得任务，确实快多了，但是似乎还可以更快: 直接把 getPage 任务交出去，开10个协程，具体谁执行，我不关心。也就是主线程只管起就行了，具体的工作全部封装了:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  urlChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line">  sizeChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i:=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">go</span> worker(urlChan, sizeChan) <span class="comment">//waiting for work</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  urlChan &lt;- url  <span class="comment">//这个分发工作也可以专门开多个协程进行 func dispath(url string, urlChan chan string)</span></span><br><span class="line">  fmt.Println(&lt;-sizeChan)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不必关心哪个线程抢到了任务。</p>
<p>worker 工作线程封装全部细节:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(urlChan <span class="keyword">chan</span> <span class="keyword">string</span>, size Chan <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    url := &lt;-urlChan</span><br><span class="line">    length, err = getPage(url)</span><br><span class="line">    <span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">      sizeChan &lt;- length</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      sizeChan &lt;- <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>多个写，多个读 goroutines 的时候，通过 chan 还是很容易控制的：</p>
<ul>
<li>生产者不断发送 url</li>
<li>消费者不断拿到 url 然后 getPage</li>
</ul>
<p>(中间可能有些协程抢不到任务，但是这属于调度任务，后续再说)。<br>总之协程让同步&amp;协作变得非常简单。</p>
<h2 id="nilChan的应用"><a href="#nilChan的应用" class="headerlink" title="nilChan的应用"></a>nilChan的应用</h2><p>如果你关闭了 chan，那么你后续将永远不再能通过这个 chan 进行读写，但是赋值为nil表示当前不再接受读写，之后再把原来的值赋值回来，则可以进行读写了。</p>
<p><code>chan = nil</code> 相当于暂时关闭，好处是避免了阻塞。give up transmitting.(读的chan不要再接收，写的chan不要在发送)</p>
<p>例如下面的: (用在 select 里面，可以暂停其他分支的执行，即当前停止读写)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"time"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"math/rand"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reader</span><span class="params">(ch <span class="keyword">chan</span> <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">  t := time.NewTimer(<span class="number">3</span> * time.Second)</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> i := &lt;-ch:</span><br><span class="line">      fmt.Println(i)</span><br><span class="line">    <span class="keyword">case</span> &lt;-t.C: <span class="comment">//3秒钟到了，暂停接收(ignore, 忽略)--chan接收一直走该分支</span></span><br><span class="line">      ch = <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writer</span><span class="params">(ch <span class="keyword">chan</span> <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">  t := time.NewTimer(<span class="number">2</span> * time.Second)</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> ch&lt;- rand.Intn(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">case</span> &lt;- t.C:</span><br><span class="line">      ch = <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line">  <span class="keyword">go</span> reader(ch)</span><br><span class="line">  <span class="keyword">go</span> writer(ch)</span><br><span class="line"></span><br><span class="line">  time.Sleep(<span class="number">10</span> * time.Second)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="关闭chan"><a href="#关闭chan" class="headerlink" title="关闭chan"></a>关闭chan</h2><p><code>close(chan)</code> 可以用于同步和协作：</p>
<ul>
<li>可以停止那些阻塞等待的协程继续，像一个广播</li>
</ul>
<p>举个例子:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ( </span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printer</span><span class="params">(msg <span class="keyword">string</span>, goChan <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line">  &lt;- goChan <span class="comment">//阻塞等待读</span></span><br><span class="line"></span><br><span class="line">  fmt.Printf(<span class="string">"%s\n"</span>, msg)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  goChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i:= <span class="number">0</span>; i&lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">go</span> printer(fmt.Sprintf(<span class="string">"printer: %d"</span>, i), goChan)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  time.Sleep(<span class="number">5</span> * time.Second)</span><br><span class="line">  <span class="built_in">close</span>(goChan) <span class="comment">//5秒过，那些阻塞等待的goroutines可以继续执行</span></span><br><span class="line">  time.Sleep(<span class="number">5</span> * time.Second)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>10个协程都阻塞等待着接收main发送的信息，但是main就是不发送；所以所有的协程阻塞，不能往下执行; 然后当 main close的时候，它们才能继续执行。</p>
<p>或者<strong>让所有 goroutines 结束</strong>:(接到这个消息后，程序流程结束)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">  <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> &lt;- stopChan:</span><br><span class="line">      <span class="keyword">return</span> <span class="comment">//终于等到消息了，程序走结束的逻辑 </span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="comment">//todo other things</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里等到消息可以是真的接收到或者，收到 close 消息。</p>
<blockquote>
<p>总结一条，其实就是停止阻塞&amp;&amp;关闭 chan.</p>
</blockquote>
<h2 id="运行时Type"><a href="#运行时Type" class="headerlink" title="运行时Type"></a>运行时Type</h2><p>其实就是 <code>interface{}</code>，编译时确定不了，只有运行时才知道具体的类型。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">whatisThis</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">  fmt.Printf(<span class="string">"%T\n"</span>, i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  whatisThis(<span class="number">10</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="typeSwitch"><a href="#typeSwitch" class="headerlink" title="typeSwitch"></a>typeSwitch</h2><p>一个可以判断类型的 switch 语句，大致语法如下: <code>switch 实例.(type)</code>，例如:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">whatisThis</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">  <span class="comment">//fmt.Printf("%T\n", i)</span></span><br><span class="line">  <span class="keyword">switch</span> i.(<span class="keyword">type</span>) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">string</span>:</span><br><span class="line">    fmt.Println(<span class="string">"a string"</span>)</span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">int</span>:</span><br><span class="line">    fmt.Println(<span class="string">"a integer"</span>)</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    fmt.Printf(<span class="string">"Don't know\n"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  whatisThis(<span class="number">10</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h2><p><code>%v</code>可以打印任何类型。如果用 <code>实例.(具体类型)</code> 那么这就是 type assertion，类型断言。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">"a integer"</span>, i.(<span class="keyword">int</span>)) <span class="comment">//如果是这种类型，那么会输出它的值；</span></span><br></pre></td></tr></table></figure>
<p>类型断言，如果失败会引发 panic:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="keyword">int</span>:</span><br><span class="line">    fmt.Println(<span class="string">"a integer"</span>, i.(<span class="keyword">string</span>)) <span class="comment">//int 值判断为 string,必定失败，panic</span></span><br></pre></td></tr></table></figure>
<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>没有继承结构 &amp;&amp; 类型体系，只有 type + method associated with them。(也没有友元之类的机制)</p>
<p>任何满足接口的类型，都可以被传递或者接收，例如:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> shuffler <span class="keyword">interface</span> &#123;</span><br><span class="line">  Len() <span class="keyword">int</span></span><br><span class="line">  Swap(i, j <span class="keyword">int</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">shuffle</span><span class="params">(s shuffler)</span></span> &#123;</span><br><span class="line">  <span class="comment">//do sth.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> intSlice []<span class="keyword">int</span> <span class="comment">//声明一种类型</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(is intSlice)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">  <span class="comment">//do sth</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(is intSlice)</span> <span class="title">Swap</span><span class="params">(i, j <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">  <span class="comment">//do sth</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接口表明了一种能力，feature。(接口内的方法应该是大写开头的)</p>
<p>你不用去表明什么子类父类，oo的概念；只要你把某种类型的实例当做某接口实例去用，那么编译时就会去检查是否正确。(你可以故意把某个接口原型写错，发现编译时就会提醒你)</p>
<blockquote>
<p>标准库到处都是使用接口的案例，比如 io，只要表明具有某种能力，那么就能实现读写</p>
</blockquote>
<h2 id="带缓冲的chan"><a href="#带缓冲的chan" class="headerlink" title="带缓冲的chan"></a>带缓冲的chan</h2><p>有点儿像队列，或者 semaphore。buffer 只要还有内容，可以不必阻塞等待。(队列里没有内容，则要阻塞等待)</p>
<p>最经典的案例，就是生产者消费者了：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"time"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"math/rand"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(sema <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line">  &lt;- sema <span class="comment">//队列为空则等待</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//假装在做任务</span></span><br><span class="line">  fmt.Print(<span class="string">"["</span>)</span><br><span class="line">  time.Sleep(time.Duration(rand.Intn(<span class="number">10</span>)) * time.Second)</span><br><span class="line">  fmt.Print(<span class="string">"]"</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//完成任务了</span></span><br><span class="line">  sema &lt;-<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  sema := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//开启 1000 个协程</span></span><br><span class="line">  <span class="keyword">for</span> i:= <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">go</span> worker(sema)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i:= <span class="number">0</span>; i&lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">    sema &lt;-<span class="literal">true</span> <span class="comment">//虽然开启了 1000 个协程，但实际工作的只有 10个</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  time.Sleep(<span class="number">10</span> * time.Second) <span class="comment">//让子 routines 有足够的时间执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实这里控制了 buffer 的数量，也就控制了最大竞争数量，换句话说，控制了同时运行的 worker 最大数量(资源池只有10个机会)。</p>
<p>除了队列(buffered chan 之外，还有 Mutex, atomic count 等同步手段)，比如 sync/atomic，运行一个协程计数少一个，完成任务再把计数器增加回来。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"time"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"math/rand"</span></span><br><span class="line">  <span class="string">"sync/atomic"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">  runningCount <span class="keyword">int64</span> = <span class="number">0</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(sema <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line">  <span class="comment">//&lt;- sema //队列为空则等待</span></span><br><span class="line">  atomic.AddInt64(&amp;runningCount, <span class="number">1</span>) <span class="comment">//消耗一个资源</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//假装在做任务</span></span><br><span class="line">  fmt.Printf(<span class="string">"[ %d"</span>, runningCount)</span><br><span class="line">  time.Sleep(time.Duration(rand.Intn(<span class="number">10</span>)) * time.Second)</span><br><span class="line">  fmt.Print(<span class="string">"]"</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//完成任务了</span></span><br><span class="line">  <span class="comment">//sema &lt;-true</span></span><br><span class="line">  atomic.AddInt64(&amp;runningCount, <span class="number">-1</span>) <span class="comment">//把资源还回来</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  sema := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//开启 1000 个协程</span></span><br><span class="line">  <span class="keyword">for</span> i:= <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">go</span> worker(sema)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i:= <span class="number">0</span>; i&lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">    sema &lt;-<span class="literal">true</span> <span class="comment">//虽然开启了 1000 个协程，但实际工作的只有 10个</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  time.Sleep(<span class="number">10</span> * time.Second) <span class="comment">//让子 routines 有足够的时间执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到用 sync/atomic 做手动控制不如直接使用 buffer chan 来控制最大资源数目。</p>
<h2 id="自定义类型"><a href="#自定义类型" class="headerlink" title="自定义类型"></a>自定义类型</h2><p>使用 type 关键字，就可以定义自定义类型了，同时也可以为他 attach 一些方法。</p>
<blockquote>
<p>更加面向对象</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"io/ioutil"</span></span><br><span class="line">  <span class="string">"net/http"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> webPage <span class="keyword">struct</span> &#123;</span><br><span class="line">  url <span class="keyword">string</span></span><br><span class="line">  body []<span class="keyword">byte</span></span><br><span class="line">  err error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w *webPage)</span> <span class="title">get</span><span class="params">()</span></span> &#123;</span><br><span class="line">  resp, err := http.Get(w.url)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"get Page err"</span>)</span><br><span class="line">    w.err = err</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line">  w.body, err = ioutil.ReadAll(resp.Body)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    w.err = err</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  w := &amp;webPage&#123;url: <span class="string">"http://www.baidu.com/"</span>&#125;</span><br><span class="line">  w.get()</span><br><span class="line">  fmt.Printf(<span class="string">"url: %s, %d length; error? %v\n"</span>, w.url, <span class="built_in">len</span>(w.body), w.err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里用的 receiver 是 pointer 类型。</p>
<p>也可以为已有类型起别名，然后为他添加一些特殊方法，例如:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> SumSlice []<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s SumSlice)</span> <span class="title">sum</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">  sum := <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> _, i := <span class="keyword">range</span> s &#123;</span><br><span class="line">    sum += i</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> s SumSlice = SumSlice&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>&#125;</span><br><span class="line">  fmt.Printf(<span class="string">"%d\n"</span>, s.sum())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是有时候操作的时候可能需要强制转换，毕竟别名和原来的内容还是有区别的。<br>(内部嵌入接口的内容，可以直接当做本接口内的，直接使用)</p>
<h2 id="多包引用"><a href="#多包引用" class="headerlink" title="多包引用"></a>多包引用</h2><p>只要注意控制路径，那么引用别的包之后就可以使用它定义的 exported 内容。</p>
<p>golang 每次 import 一个包的时候会做一些初始化的工作:（需要自己去实现）</p>
<ul>
<li>引入全局变量</li>
<li>全局函数 (一般用于初始化包内变量的工作)</li>
</ul>
<p>注意大小写规则，一般包内的私有变量外部如果想访问，应该专门给它写一个Getter。</p>
<h2 id="Go-Tools"><a href="#Go-Tools" class="headerlink" title="Go Tools"></a>Go Tools</h2><blockquote>
<p>为什么 Go 一般不需要外部的 shell/makefile 来进行编译 &amp; 依赖管理？</p>
</blockquote>
<p>因为 golang 中的 import + Go tool chain 已经做好了编译和依赖管理，而且做得不做。</p>
<p>go install : 编译之后，装到 bin 目录 (go install 对应目录即可，不用指定到 xxx.go 文件) — src/hello, go install hello 即可<br>go build : 仅仅是编译，但是不安装到相应的目录 (如果你没有可执行文件，那么根本不用 install, 直接 go build 即可)<br>go run : 直接针对 .go 文件(而不是 package 或者目录的名字)，然后运行一个临时的可执行文件<br>go vet : 在 package 基础上检查运行时错误的(不用刻意编译运行之后才发现错误，直接 go vet 发现运行时检查)<br>go test: 支持单元测试</p>
<p>编译的时候，自动根据 import 做好依赖处理&amp;编译，同时也会在 pkg 目录生成目标平台的 .a 文件。</p>
<p>go 的编译问题，不用刻意去谈依赖，import 就解决了。(并且并行编译)</p>
<h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>主要是使用<code>go test</code>，虽然实际生产上实际使用的是更加专业的框架。来简单看一下吧:(实际内容也不少，规则不少)。</p>
<blockquote>
<p>这里比较有意思，老师故意写了一个带有 Bug 的程序，然后通过单元测试找到了问题</p>
</blockquote>
<p>Golang 里面不太喜欢用 Getter 之类的方法，而直接写变量的名字。</p>
<p><img src="http://www.commoncommonheart.com/wp-content/uploads/2018/03/unit0.jpg" alt=" "></p>
<p>主要代码如下：(正常运行)</p>
<p><img src="http://www.commoncommonheart.com/wp-content/uploads/2018/03/unit1.jpg" alt=" "></p>
<p><img src="http://www.commoncommonheart.com/wp-content/uploads/2018/03/unit2.jpg" alt=" "></p>
<p>然后写一个专门的单元测试: (T型，B型)</p>
<p><img src="http://www.commoncommonheart.com/wp-content/uploads/2018/03/unit3.jpg" alt=" "></p>
<p><code>go test</code> 然后报错了，因为 poem 里面只有一个 Stanzas。</p>
<p>(其实还有一个错误，那个统计原因字符的函数，没有考虑其他字符如逗号以及空格的情况)</p>
<p>Fatalf 会立即终止测试运行，而 Errorf 则不会。(一般使用 Fatalf 立即停止)</p>
<blockquote>
<p>最后，所有的单元测试，都是以包为单位的: 写上 package 之后，直接引用 testing 即可。</p>
</blockquote>
<h2 id="标准库部分"><a href="#标准库部分" class="headerlink" title="标准库部分"></a>标准库部分</h2><p>这部分单独写吧，大师讲的非常不错。参考 <a href="http://www.merlinblog.site/categories/StdGolang%E4%B8%93%E6%A0%8F/">《StdGolang专栏》</a></p>
<p>最后，大师露个脸 : )</p>
<p><img src="http://www.commoncommonheart.com/wp-content/uploads/2018/03/golangmaster1.jpg" alt=" "></p>
<h2 id="Web开发"><a href="#Web开发" class="headerlink" title="Web开发"></a>Web开发</h2><p>这位导师也是点到为止，但是不够详细。</p>
<p>参考：<a href="http://www.merlinblog.site/categories/WebGolang%E4%B8%93%E6%A0%8F/">《WebGolang专栏》</a></p>
<hr>
<p>Merlin 2018.3.11 大师讲课不忘黑一下其他语言，笑; 京东看了下在售的 golang 相关的书不值得购买</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/posts/94df7563/">Golang: Here We Go(5.孰能生巧-Oreilly大师讲解&amp;再练习)</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">Merlin</a></p>
        <p><span>发布时间:</span>2018-03-11, 12:23:24</p>
        <p><span>最后更新:</span>2018-04-12, 14:55:17</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/posts/94df7563/" title="Golang: Here We Go(5.孰能生巧-Oreilly大师讲解&amp;再练习)">http://www.merlinblog.site/posts/94df7563/</a>
            <span class="copy-path" data-clipboard-text="原文: http://www.merlinblog.site/posts/94df7563/　　作者: Merlin" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/posts/187d6c5a/">
                    Golang: WebGoGoGo(0.概述Web编程)
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/posts/53a29a57/">
                    Golang: RobPike谈 并发Vs并行
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hello"><span class="toc-number">1.</span> <span class="toc-text">Hello</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#目录讲解"><span class="toc-number">2.</span> <span class="toc-text">目录讲解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文档"><span class="toc-number">3.</span> <span class="toc-text">文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#变量"><span class="toc-number">4.</span> <span class="toc-text">变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#字符串"><span class="toc-number">5.</span> <span class="toc-text">字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#if语句"><span class="toc-number">6.</span> <span class="toc-text">if语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#switch语句"><span class="toc-number">7.</span> <span class="toc-text">switch语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#for循环"><span class="toc-number">8.</span> <span class="toc-text">for循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#函数定义"><span class="toc-number">9.</span> <span class="toc-text">函数定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#不定参数"><span class="toc-number">10.</span> <span class="toc-text">不定参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数组和切片"><span class="toc-number">11.</span> <span class="toc-text">数组和切片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#map"><span class="toc-number">12.</span> <span class="toc-text">map</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#byte切片"><span class="toc-number">13.</span> <span class="toc-text">byte切片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误异常"><span class="toc-number">14.</span> <span class="toc-text">错误异常</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#协程-amp-chan"><span class="toc-number">15.</span> <span class="toc-text">协程&amp;chan</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#select语句"><span class="toc-number">16.</span> <span class="toc-text">select语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chan读写超时"><span class="toc-number">17.</span> <span class="toc-text">chan读写超时</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#传递chan"><span class="toc-number">18.</span> <span class="toc-text">传递chan</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多个协程实现线程池"><span class="toc-number">19.</span> <span class="toc-text">多个协程实现线程池</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nilChan的应用"><span class="toc-number">20.</span> <span class="toc-text">nilChan的应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关闭chan"><span class="toc-number">21.</span> <span class="toc-text">关闭chan</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运行时Type"><span class="toc-number">22.</span> <span class="toc-text">运行时Type</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#typeSwitch"><span class="toc-number">23.</span> <span class="toc-text">typeSwitch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#类型断言"><span class="toc-number">24.</span> <span class="toc-text">类型断言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#接口"><span class="toc-number">25.</span> <span class="toc-text">接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#带缓冲的chan"><span class="toc-number">26.</span> <span class="toc-text">带缓冲的chan</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义类型"><span class="toc-number">27.</span> <span class="toc-text">自定义类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多包引用"><span class="toc-number">28.</span> <span class="toc-text">多包引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Go-Tools"><span class="toc-number">29.</span> <span class="toc-text">Go Tools</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单元测试"><span class="toc-number">30.</span> <span class="toc-text">单元测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#标准库部分"><span class="toc-number">31.</span> <span class="toc-text">标准库部分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web开发"><span class="toc-number">32.</span> <span class="toc-text">Web开发</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>





    




    <div class="scroll" id="post-nav-button">
        
            <a href="/posts/187d6c5a/" title="上一篇: Golang: WebGoGoGo(0.概述Web编程)">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/posts/53a29a57/" title="下一篇: Golang: RobPike谈 并发Vs并行">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/posts/2ff459d4/">Android: 彙編語言基礎</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/7ef0bd11/">技巧: iOS 工作流</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/1e2300e0/">Golang: 并发聊天室综合案例</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/74edbb6d/">Golang: TCP 文件传输案例</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a8342f6/">Golang: TCP 简单并发服务器</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/aa0a3cc6/">技巧: B站视频下载脚本</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8180668e/">技巧: 多用户共享 Parralles 虚拟机</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/55b0329b/">Golang: 值类型&引用类型坑(12)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ac5ecee9/">Golang: 函数类型实现接口封装问题(11)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/eecafb73/">Golang: struct打印输出问题(10)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8f54ef0c/">Golang: string和byte slie字节问题(9)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8a7f81db/">Golang: time计算问题(8)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/d4333ec1/">Golang: chan定义问题(7)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/aec4de55/">Golang: defer 时机问题(6)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e9bf7e00/">Golang: make和new坑(5)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e0c9893e/">Golang: import和package坑(4)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4ff88030/">Golang: runtime.Gosched 问题(3)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/690caed4/">Golang: HTML Template案例(xml新闻解析+并发改进)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4620296/">Golang: JSON 小案例(读配置文件)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/777e9274/">Golang: JSON 综合案例(天气预报)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/21f718fc/">Golang: RESTful 小案例</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ad1d8b3/">Golang: 泛型容器的安全问题 (2)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/3fde375b/">Golang: 内嵌真的不是继承 (1)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ede42ab6/">Golang: 注意空接口运行时类型 (0)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/bd0987da/">Android: 音频框架&驱动解析</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/6c3c68b0/">Gcc: Gcc优化指南(5. 功成身退-总结)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/466242ae/">Gcc: Gcc优化指南(4. Gcc & G++ & 相关工具)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/425935e0/">Gcc: Gcc优化指南(3. Gcc Optimize-核心)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/5cd24f32/">Gcc: Gcc优化指南(2. Gcc Options)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/11ea881a/">Gcc: Gcc优化指南(1. Common Problmes of Path & Libs)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/1e58a5cc/">量化: 数学和量化研究(0. 总起)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e6805cb0/">Gcc: Gcc优化指南(0. Basic Skills)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/78268fe4/">Golang: 标准库解决方案(8.总结-功成身退)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e3c9a06b/">Golang: 标准库解决方案(7.Concurrency)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/bb600d10/">Golang: 标准库解决方案(6.REST & JSON API)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/2f5310cf/">Golang: 标准库解决方案(5.Web Server & Client)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/40bd3fcc/">Golang: 标准库解决方案(4.Math/Time/Archives/Images)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/fedfbade/">Golang: 标准库解决方案(3.处理BuildTools,IO,Error)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/42e1a67a/">Golang: 标准库解决方案(2.处理Strings,Bytes,Runes)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/461f0c5f/">Golang: 标准库解决方案(1.听两位大师讲标准库)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/dbbca7df/">Golang: WebGoGoGo(0.Web编程的方方面面)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/187d6c5a/">Golang: WebGoGoGo(0.概述Web编程)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/94df7563/">Golang: Here We Go(5.孰能生巧-Oreilly大师讲解&再练习)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/53a29a57/">Golang: RobPike谈 并发Vs并行</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/9b9dc4cb/">Golang: One Video Golang</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/9d17f938/">Golang: 标准库解决方案(0.总起)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e5c13927/">Golang: Think in Golang</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/514585e8/">Golang: Here We Go(4.功成身退-资料&面试题)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4f07614d/">Golang: Here We Go(3.登堂入室-全部语法&大量练习)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/872df2cf/">Golang: Here We Go(2.常用命令&代码结构&语法大纲)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/51cffabe/">Golang: Here We Go(1.安装&&脚本)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/d740c2ec/">Golang: Here We Go(0.Google工程师介绍)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/590c21ce/">V-skills 专栏指南</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/df51d2c/">技巧: Hexo 置顶问题解决</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4111adcd/">技巧: WordPress 迁移&备份技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/d61966e4/">略懂: Nginx 折腾</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/12cc604a/">技巧: WordPress upload 最终解决方案</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/173f9602/">技术: 深耕 Docker 生态圈(十一){Docker 实践}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/5ac3e07f/">技巧: Wordpress 网页(h5) mp4 兼容问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/65a942dd/">技术: 深耕 Docker 生态圈(十一){Docker 三剑客}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a30c0f5f/">技术: 深耕 Docker 生态圈(十){私有仓库配置}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/c73a742c/">技术: 深耕 Docker 生态圈(九){Docker 数据管理}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/19c3a85f/">技术: 深耕 Docker 生态圈(八){Docker 网络部分}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b3512db9/">技术: 深耕 Docker 生态圈(七){Docker 的底层实现}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/cd70a238/">技术: 深耕 Docker 生态圈(六){Dockerfile 文法}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/36bc3b47/">技术: 深耕 Docker 生态圈(五){自己构建的镜像为何这么大}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/cb3fb6f1/">技术: 深耕 Docker 生态圈(四){镜像存储在哪}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e0391b88/">技术: 深耕 Docker 生态圈(三){Docker 指令}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8abfca36/">技术: 深耕 Docker 生态圈(二){配置 Docker }</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/70ca69ad/">技术: 深耕 Docker 生态圈(一){总起:安装环境}</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/9724f8c0/">传送门(Gate)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/683530b4/">略懂: Docker 镜像与容器</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ab11b0d1/">略懂: 软件架构模式</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e1b58964/">技术: Sqlite 主键自增(Python接口)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/121fc86a/">技巧: 迁移博客到 VPS (借助hook)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/337aa775/">略懂: 我所认识的 Nodejs</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/f8bb990d/">技巧: iOS 原生客户端配置 Gmail</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ecd9f8c2/">略懂: 前端相关的缓存技术</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/9b49ffe2/">Golang: 深入探究 Golang 并发</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/5009ef69/">技巧: macOS 录屏保存为 gif 格式</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/85a160b/">技巧: Numbers(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/d3fb236/">Golang: Golang 代码走廊</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/16ca5b11/">技巧: Git 多账户工作技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/7fcc01c2/">技巧: macOs下Qt的Mysql驱动处理</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e1b7f878/">技术: Qt 汇总篇</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/15783ed7/">技巧：Makefile相关</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ad67147c/">技巧: HEXO优雅操作</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/aa213556/">技巧: macOS中替换rm命令</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ef21388e/">技术: 股票分析客户端分析与实现</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/38fb8eb9/">技术: 网络编程部分汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a7d41a1/">技术: C++最终篇</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ba598705/">技术: Emacs环境配置</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/3549e702/">技术: Deepin Linux环境配置</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/1345f1a4/">技术: 网络吞吐量测试</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/65b929a8/">技术: 浅谈我经历的敏捷</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8804d39c/">技术: 网络开发常用工具</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/6acc3344/">技术: Thrift</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8276c32/">技术: rapid-json</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/17d1767e/">技术: Rapid Xml</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/7d13442/">技术: Protocol buffer</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/140bfd50/">技术: Gtest测试框架</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/247b42a4/">技术: 多线程调试问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/d48acbe2/">技术: TDD 开发模式实践</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/47fb15b8/">技术: 一个HTTPd的简单实现</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/c62cfa29/">技术: C++网络库(轮子)大杂烩</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/9d5b3554/">技术: Asio 异步IO库</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e5af6e18/">技术: Boost库</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/3cd43f14/">技术: Unix Domain Socket</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/87cd3741/">技术: 百万连接问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/1d57da8b/">技术: C++ 实现线程池模型</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/6b518c8a/">技术: 服务端网络模型</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e42d6398/">技术: UDP 模型网络编程</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/224e60da/">技术: TCP 模型网络编程</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/df7a2188/">技术: TCP流解析(粘包和拆包问题)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/1334152b/">技术: Epoll 模型</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8967f437/">技术: Linux 基础套接字模型</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/81fba862/">技术: Linux网络学习参考</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a4602dea/">技术: Linux网络IO模型</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/cf64f3cd/">技术: Shell代码规范</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/33327382/">技术: 开源协议</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/be94ecde/">技术: Git 代码规范</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/1a10be5a/">技术: Python代码规范</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/cc8315f3/">技术: 高质量Git工作</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/3a357315/">技术: Python语言</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/82524a2d/">技术: Qt 网络编程案例汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a46fcd49/">技术: Qt 线程案例汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e3b79a82/">技巧: linux下查看二进制文件</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/5d0a2cfa/">技术: Qt 实践(汽车销量管理)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/77d8483b/">技巧: Qt 快捷键</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/75110831/">技术: JNI</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/fdc9b2b9/">技术: C++编程之time问题总结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e6ff0a80/">技术: C++11 Lambda 再探究</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b84fe139/">技术: 对比 Linux 下并发库</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/322ce852/">技术: C++11 特性补充</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/189d21c8/">技术: benchmark(lambda 和 bind)</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/97d0104d/">技术: C++11 可调用对象function总结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/d12695b6/">技术: C++11 std::ref 总结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b43344a7/">技术: C++ 智能指针实现</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4ead806a/">技术: C++11 Bind 探究</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/9ef88011/">技术: C++ RAII 相关技术总结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/bb36bf0d/">技术: C++11 Lambda 探究</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4b19001a/">技术: Linux Bin Utils</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/31dce1ea/">技术: C++ 智能指针</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/88802625/">技术: Linux 静态&动态库</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ab21303c/">技术: C++11 并发库</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/bc67b8cb/">技术: 探究一下STL常用算法</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/640d4b5f/">技术: Linux 编程三大件儿</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/24da8a94/">技术: C++ 迭代器失效问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e53c44b8/">技术: C++ 标准库 STL</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/f4144d45/">技术: C++非面向对象部分</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/f8283c77/">技术: C++面向对象部分</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/be09a73/">技术: 设计模式 C++ 实现</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/956ee661/">技术: mysql-connector-cpp</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b0dbc55e/">技术: 带有移动语义的 C++ 字符串类</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/f306f9f9/">技术: C++11 右值相关问题探讨</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e9705375/">技术: C++11 类型萃取</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/d93a00e8/">技术: C++11 异常争论</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b7fe58b8/">技术: C++11 模板别名探究</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/72ae9d55/">技术: C++11 默认函数问题探究</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a8af70c7/">技术: C++11 auto和decltype总结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/c8bce253/">技术: Java中正则表达式支持</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/866a6247/">技术: Python中正则表达式的支持</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8ebc387/">技术: C++中正则表达式的支持</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/50c77f46/">技术: C语言中正则表达式的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/aea53521/">技术: C++11 tuple 容器</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/656a02b/">技术: C++11 hashtable 结构</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4bb5bf03/">技术: C++11 一致性初始化探究</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e6f297fb/">技术: C++11 RangeFor探究</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/70b6b9e7/">技术: C++11 explicit注意事项</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/919162f1/">技术: C++11 nullptr探究</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b744aae/">技术: C++11变长参数模板</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/5f4ce2b/">技术: 探究 Linux 线程</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/1312cbe7/">技术: 探究 Linux 进程</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/1d2bfb39/">技术: Posix标准一览</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a00e5a90/">隐修者(里程碑)</a></li></ul>




    <script>
        
            yiliaConfig.fancybox = false;
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2015-2018 &nbsp Merlin
            </div>
            <div class="footer-right">
                 blog&nbsp<b>version: </b> &nbsp<a href= "https://github.com/WizardMerlin/Gate#blog版本分支说明" >2.4</a>    <i class="fa fa-heart animated infinite pulse"></i>&nbsp高效流
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
    <script src="/js/GithubRepoWidget.js"></script>

<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 1;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-110654443-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
             github: ".github-widget a", 
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "Do One Thing......" + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "Do It Well......" + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>