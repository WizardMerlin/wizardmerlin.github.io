<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>binutils-in-linux | Merlin&#39;s Blog</title>
  <meta name="author" content="MerlinYu">
  
  <meta name="description" content="linux下开发需要使用到的工具链">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="binutils-in-linux"/>
  <meta property="og:site_name" content="Merlin&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="ico">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Merlin&#39;s Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> binutils-in-linux</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> linux下开发需要使用到的工具链
		 </div> <!-- alert -->
	  		

	  <p>注意这里说的是 <code>bin utils</code> 而不是 <code>core utils</code>, 所以只包含开发相关, 不包括运维相关.<br>大致上有: ar, as, ld, nm, objcopy, objdump, ranlib, readelf, size, strings, strip</p>
<a id="more"></a>
<h1 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h1><p>binutils工具链: </p>
<ul>
<li>ar 静态库生成(打包)</li>
<li>as 汇编器(略)</li>
<li>ld 链接器和ldd配置器</li>
<li>nm 查看目标文件中的符号</li>
<li>objcopy 复制目标文件 (例如去除某些ELF目标文件)</li>
<li>ranlib 为静态库创建索引, 相当于ar的s选项</li>
<li>readelf 解读ELF文件头</li>
<li>size 列出目标文件每一个断的大小和总的大小</li>
<li>strings 列出目标文件中的字符串</li>
<li>strip 去除目标文件中的所有符号(使目标文件尺寸减小)</li>
</ul>
<p>(比较常用的, ar, nm, objdump, ld, strip)<br>glibc linux下标准c库(包括linux系统库), 库就不说了.</p>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="ar"><a href="#ar" class="headerlink" title="ar"></a>ar</h2><p>当你使用rapidjson, rapidxml, gtest等这类只有头文件的库时, 链接时直接指定库文件本身, 实际上就是在使用<code>.o</code>文件.</p>
<p>ar静态链接器, 或者说一个<code>.o</code>文件的打包器, 就相当于把一些列.o追加到.a的末尾, 然后链接时写入可执行文件, 或者最终的object对象文件. </p>
<p>总结一句话, 打包生成<code>.a</code>文件, 例如生成静态库的libmytest.a :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ar cqs libmytest.a myfun.o</div></pre></td></tr></table></figure></p>
<p>具体解释:</p>
<ul>
<li>c 表示无提示模式创建文件包</li>
<li>q 表示在文件包尾加入 myfun.o</li>
<li>s 强制重新生成文件包的符号表</li>
</ul>
<p>其实代替 q 选项, 常用<code>r</code>选项, r表示在文件包中代替文件, 特别是你更新了.o文件时. 最常用的是<code>ar crs</code> 生成.a. </p>
<p>注意区别一下 <code>gcc -static</code> 命令: 这个命令在链接的时候,不管你给的是静态库还是动态库, 统统的按照静态库的方式链接, 即把所有代码都编到可执行文件中.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ gcc test_main.c -static -o test_main -lpthread</div></pre></td></tr></table></figure></p>
<p>然后你nm一下可执行文件<code>test_main</code>, 发现超级大:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">0000000000404fb0 T __pthread_cleanup_push</div><div class="line">0000000000404fb0 T _pthread_cleanup_push</div><div class="line">                 w _pthread_cleanup_push_defer</div><div class="line">                 w __pthread_cleanup_upto</div><div class="line">0000000000402fb0 W pthread_create</div><div class="line">0000000000402fb0 T __pthread_create_2_1</div><div class="line">0000000000405870 T __pthread_current_priority</div><div class="line">00000000006d6dd8 B __pthread_debug</div><div class="line">0000000000405060 T __pthread_disable_asynccancel</div><div class="line">0000000000405000 T __pthread_enable_asynccancel</div><div class="line">00000000006d6df0 B __pthread_force_elision</div><div class="line">0000000000405fe0 T __pthread_get_minstack</div><div class="line">0000000000404cf0 T __pthread_getspecific</div><div class="line">0000000000404cf0 T pthread_getspecific</div><div class="line">00000000006ceec0 D __pthread_init_array</div><div class="line">0000000000405cc0 T __pthread_initialize_minimal</div><div class="line">0000000000405cc0 T __pthread_initialize_minimal_internal</div><div class="line">0000000000402790 T __pthread_init_static_tls</div><div class="line">0000000000404070 T pthread_join</div><div class="line">0000000000404c50 T __pthread_key_create</div><div class="line">0000000000404c50 T pthread_key_create</div></pre></td></tr></table></figure></p>
<p>(gcc -shared请看下面的ld)</p>
<h2 id="ld"><a href="#ld" class="headerlink" title="ld"></a>ld</h2><p>首先把ldd和ld区分以下:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">which</span> ldd</div><div class="line">/usr/bin/ldd</div><div class="line"></div><div class="line">$ <span class="built_in">which</span> ld</div><div class="line">/usr/bin/ld</div><div class="line"></div><div class="line">$ file /usr/bin/ldd</div><div class="line">/usr/bin/ldd: Bourne-Again shell script, ASCII text executable</div><div class="line"></div><div class="line">$ file /usr/bin/ld</div><div class="line">/usr/bin/ld: symbolic link to `ld.bfd<span class="string">'</span></div><div class="line"></div><div class="line">$ file /usr/bin/ld.bfd</div><div class="line">/usr/bin/ld.bfd: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), </div><div class="line">dynamically linked (uses shared libs), for GNU/Linux 2.6.24, </div><div class="line">BuildID[sha1]=0xc81e82fe3f0377d917c3fc91c24771ea786911f9, stripped</div></pre></td></tr></table></figure></p>
<p><code>ld</code>是链接器(动态装入器), 一个可执行程序; 用gcc或者g++链接的时候自动调用, 链接语句比较复杂, 交给gcc处理吧:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#编译的时候还是要使用-fPIC, 链接的时候指定-shared, 不加shared的话, gcc也是优先链接动态库的</span></div><div class="line">$ gcc -shared –o libmyjob.so myjob.o</div></pre></td></tr></table></figure></p>
<p>(当然还有一个工具, 用来专门生成库 libtool)</p>
<p><code>ldd</code> 命令其实是依靠设置一些环境变量而实现的, 是一个shell脚本主要设置ld链接器的so库目录, 也就是说ldd的作用只是设置一些环境变量的值. 当然你也可以拿ldd看一个库是不是动态库: <code>ldd filename</code> , 例如:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ldd /bin/ln</div><div class="line">libc.so.6 =&gt; /lib/libc.so.6 (0x40021000)</div><div class="line">/lib/ld-linux.so.2 =&gt; /lib/ld-linux.so.2 (0x40000000)</div></pre></td></tr></table></figure></p>
<p>或者查看它的版本:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ ldd --version</div><div class="line">ldd (Ubuntu EGLIBC 2.15-0ubuntu10.18) 2.15</div><div class="line">Copyright (C) 2012 Free Software Foundation, Inc.</div><div class="line">This is free software; see the <span class="built_in">source</span> <span class="keyword">for</span> copying conditions.  There is NO</div><div class="line">warranty; not even <span class="keyword">for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</div><div class="line">Written by Roland McGrath and Ulrich Drepper.</div></pre></td></tr></table></figure></p>
<p>ldd通过 <code>/etc/ld.so.conf</code> 文件指示链接时, ld需要链接的库:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat /etc/ld.so.conf</div><div class="line">include /etc/ld.so.conf.d/*.conf</div><div class="line"></div><div class="line">/usr/<span class="built_in">local</span>/ssl/lib</div></pre></td></tr></table></figure></p>
<p>也就是是说 <code>/etc/ld.so.conf.d/*.conf</code> 里面的所有 <code>.conf</code>文件指示了目录:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ cat /etc/ld.so.conf.d/*.conf</div><div class="line"><span class="comment"># libc default configuration</span></div><div class="line">/usr/<span class="built_in">local</span>/lib</div><div class="line">/usr/<span class="built_in">local</span>/lib</div><div class="line"><span class="comment"># Multiarch support</span></div><div class="line">/lib/x86_64-linux-gnu</div><div class="line">/usr/lib/x86_64-linux-gnu</div></pre></td></tr></table></figure>
<p>这下全明白了. 当你更新 <code>/etc/ld.so.conf</code>相关的配置文件, 并不一定能引入新的链接路径, 因为还要依靠<code>ldconfig</code>命令把相关内容更新到<code>/etc/ld.so.cache</code>, 这时链接器ld才能在链接的时候进行装入.</p>
<p>当然ldconfig不仅仅可以更新库路径, 还可以查看具体会链接到的库(当前在/etc/ld.so.cache中指定的), 例如:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ldconfig -p | less</div><div class="line">$ ldconfig -p | grep <span class="string">"pthread"</span></div></pre></td></tr></table></figure></p>
<p>即便是链接的时候, 使用了 “gcc -L”以及”-l”选项, 运行的时候, 也不一定能运行(运行的时候会在指定的库地址找到相应代码实现), 除非你的库一直都在被相关的conf文件记录了, 也就是说运行的时候也要指定库路径. 此时可以使用”LD_LIBRARY_PATH”来添加临时的路径.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># export LD_LIBRARY_PATH="/usr/lib/old:/opt/lib"</span></div></pre></td></tr></table></figure></p>
<p>(当然, 您可以把这句写入您的<code>.bashrc</code>里面, 每次运行shell都会导入)而且<code>LD_LIBRARY_PATH</code>指定的路径优先查找;(这样可以在您本机的某些库比较旧, 不满足要求时, 优先链接比较新的, 您指定的库).</p>
<p>下面nm, objdump, readelf 三个功能有重合, 我推荐的是用好简单的nm和最强大的readelf, 了解objdump.</p>
<hr>
<h2 id="nm"><a href="#nm" class="headerlink" title="nm"></a>nm</h2><p>nm 查看目标文件中的符号(display symbol table from an object file), 这个常和 <code>readelf</code> , <code>objdump</code>纠缠不清, 可以肯定的是, nm对于解读目标文件中的符号更专业, 而readelf则通用于解读elf头信息(Displays information about ELF format object files.), 而<code>objdump</code>这个相当于nm的超集.</p>
<p>目标文件可以是是最终的可执行文件, 当然也可以是’.o’文件, 甚至是<code>.so</code>文件( 通常是库文件和可执行文件).<br><code>man nm</code>得到如下信息:<br>(man手册是写给懂的人看的)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">nm [-a|--debug-syms]</div><div class="line">  [-g|--extern-only][--plugin name]</div><div class="line">  [-B] [-C|--demangle[=style]] [-D|--dynamic]</div><div class="line">  [-S|--print-size] [-s|--print-armap]</div><div class="line">  [-A|-o|--print-file-name][--special-syms]</div><div class="line">  [-n|-v|--numeric-sort] [-p|--no-sort]</div><div class="line">  [-r|--reverse-sort] [--size-sort] [-u|--undefined-only]</div><div class="line">  [-t radix|--radix=radix] [-P|--portability]</div><div class="line">  [--target=bfdname] [-fformat|--format=format]</div><div class="line">  [--defined-only] [-l|--line-numbers] [--no-demangle]</div><div class="line">  [-V|--version] [-X 32_64] [--help]  [objfile...]</div></pre></td></tr></table></figure></p>
<p>常用的选项如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-A: 每个符号前显示文件名</div><div class="line">-s: --print-armap</div><div class="line">-D: 显示动态符号 </div><div class="line">-g: 仅显示外部符号</div><div class="line">-r: 反序显示符号表</div></pre></td></tr></table></figure></p>
<p>-s和-D是相对的, 一个用于查看静态库, 一个用于查看动态库:</p>
<ul>
<li><code>[-s|--print-armap]</code>, When listing symbols from archive members, include the index: a mapping (stored in the archive by ar or ranlib) of which modules contain definitions for which names (当列出库中成员的符号时, 包含索引, 索引的内容包含:哪些模块包含哪些名字的映射)</li>
<li><code>[-D|--dynamic]</code>显示动态符号, 该任选项仅对于动态目标(例如特定类型的共享库)有意义.</li>
</ul>
<p>无论如何 nm 都会列出其值(the symbol value), 类型(the symbol type)和其名字(the symbol name), 例如 <code>nm -s main</code> 得到:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">00000000004060e0 T __libc_csu_fini</div><div class="line">0000000000406050 T __libc_csu_init</div><div class="line">                 U __libc_start_main@@GLIBC_2.2.5</div><div class="line">                 U __stack_chk_fail@@GLIBC_2.4</div><div class="line">00000000006090b0 A _edata</div><div class="line">00000000006091d8 A _end</div><div class="line">00000000004060e4 T _fini</div><div class="line">0000000000400b00 T _init</div><div class="line">0000000000400c60 T _start</div><div class="line">0000000000400c8c t call_gmon_start</div><div class="line">00000000006091d0 b completed.7516</div><div class="line">00000000006090a0 W data_start</div><div class="line">0000000000400cb0 t deregister_tm_clones</div><div class="line">0000000000400d50 t frame_dummy</div><div class="line">0000000000400d78 T main</div></pre></td></tr></table></figure></p>
<p>上面的值, 都是16进制的, 每个符号的值的具体含义依其类型而异, 并且其类型, 其值以及它们所属的section是密切相关的(可能是编译地址, 也可能是绝对值).</p>
<p>下面列举了其类型的含义:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">A </div><div class="line">该符号的值是绝对的，在以后的链接过程中，不允许进行改变。</div><div class="line">这样的符号值，常常出现在中断向量表中，例如用符号来表示各个中断向量函数在中断向量表中的位置。</div><div class="line"></div><div class="line">B </div><div class="line">该符号的值出现在非初始化数据段(bss)中</div><div class="line">例如，在一个文件中定义全局static int test。</div><div class="line">则该符号test的类型为B，位于bss section中</div><div class="line">其值表示该符号在bss段中的偏移.</div><div class="line">一般而言，bss段分配于RAM中</div><div class="line"></div><div class="line">C </div><div class="line">该符号为common symbol, 未初始话数据段.</div><div class="line">只有在链接过程中才进行分配, 符号的值表示该符号需要的字节数。</div><div class="line">例如在一个c文件中，定义int test，并且该符号在别的地方会被引用，</div><div class="line">则该符号类型即为C, 否则其类型为B。</div><div class="line"></div><div class="line">D </div><div class="line">该符号位于初始话数据段中。</div><div class="line">一般来说，分配到data section中。</div><div class="line">例如定义全局int baud_table[5] = &#123;9600, 19200, 38400&#125;，</div><div class="line">则会分配于初始化数据段中</div><div class="line"></div><div class="line">G </div><div class="line">该符号也位于初始化数据段中</div><div class="line">主要用于small object提高访问small data object的一种方式</div><div class="line"></div><div class="line">I </div><div class="line">该符号是对另一个符号的间接引用</div><div class="line"></div><div class="line">N </div><div class="line">该符号是一个debugging符号</div><div class="line"></div><div class="line">R </div><div class="line">该符号位于只读数据区。</div><div class="line">例如定义全局const int test[] = &#123;123, 123&#125;;</div><div class="line">则test就是一个只读数据区的符号。</div><div class="line"></div><div class="line">一般而言，位于rodata section。</div><div class="line">值得注意的是，如果在一个函数中定义</div><div class="line">const char *test = “abc”, </div><div class="line">const char test_int = 3。</div><div class="line">使用nm都不会得到符号信息，</div><div class="line">但是字符串“abc”分配于只读存储器中，</div><div class="line">test在rodata section中，大小为4。</div><div class="line"></div><div class="line">S </div><div class="line">符号位于非初始化数据区，用于small object</div><div class="line"></div><div class="line">T </div><div class="line">该符号位于代码区text section</div><div class="line"></div><div class="line"></div><div class="line">U </div><div class="line">该符号在当前文件中是未定义的，即该符号的定义在别的文件中。</div><div class="line">例如，当前文件调用另一个文件中定义的函数，</div><div class="line">在这个被调用的函数在当前就是未定义的；</div><div class="line">但是在定义它的文件中类型是T, 但是对于全局变量来说，</div><div class="line">在定义它的文件中，其符号类型为C.</div><div class="line"></div><div class="line">V </div><div class="line">该符号是一个weak object。</div><div class="line"></div><div class="line">W </div><div class="line">The symbol is a weak symbol that has not been </div><div class="line">specifically tagged as a weak object symbol.</div><div class="line"></div><div class="line">- </div><div class="line">该符号是a.out格式文件中的stabs symbol</div><div class="line"></div><div class="line">? </div><div class="line">该符号类型没有定义</div></pre></td></tr></table></figure></p>
<p>符号定义常用的也就是 U和T, 用来查看具体的定义或者调用关系.(这也就是你可能需要看符号表的原因吧, 我看看代码到底是调用到了哪里, 然后利用符号的值去相应的动态库或者其他obj中找到这些符号, 弄清楚调用关系; 或者查看某个值—这个的话一般用gdb调试), 简单总结如下:<br>(小写的, 表示对应的Local; 大写global)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">A    Global absolute 绝对符号(a则表示 Local absolute 符号)</div><div class="line">     其他都是偏移符号</div><div class="line">B    bss 符号 (b表示局部)--未初始化</div><div class="line">C    动态分配的符号</div><div class="line">D    Global data 符号(d表示局部) --初始化</div><div class="line">f    源文件名称符号</div><div class="line">T    Global text 符号</div><div class="line">t    Local text 符号</div><div class="line">U    未定义符号(定期在别处, 此处只是使用)</div><div class="line">W    表示如果其他函数库中也有对这个符号的定义</div><div class="line">     则其他符号的定义可以覆盖这个定义</div></pre></td></tr></table></figure></p>
<p>(上面的符号表示, 在 objdump 和 readelf 命名里也适用)<br>使用nm前, 最好先用<code>file</code>查看对象文件所属处理器架构, 然后再用相应交叉版本的nm工具. 当然编译<code>.o</code>文件的时候一定要使用 <code>-g</code>参数, 否则没有符号信息.</p>
<p>(个人认为: 论功能的强大上, readelf &gt; objdump &gt; nm)</p>
<p>主推2个选项:</p>
<ul>
<li>-s: –print-armap</li>
<li>-D: 显示动态符号(用-D的时候-g没啥用,反正都是外部链接的)</li>
<li>-r: 反向详细调用关系</li>
</ul>
<h2 id="objdump"><a href="#objdump" class="headerlink" title="objdump"></a>objdump</h2><p>这个命令不要太强大啊, 能实现上述命令(ar,nm, readelf)的很多功能. 它主要是查看对象文件的内容信息(包括各个section段). 上面说 <code>nm -s</code>的时候, 提到了<code>objdump -t</code>, 查看符号表的入口信息, 通俗说也就是显示目标文件的符号信息(symbol table), 值, 类型, 名称等(比nm -s稍微详细一点; 但不包括显示动态库的内容, 即<code>nm -D</code>的内容).</p>
<p>查看所有段的头部内容可以使用<code>objdump -h</code>.</p>
<p>当然这个命令还可以用于反汇编查看, 不过最主要的记住<code>-t</code>和<code>-h</code>选项.</p>
<h2 id="readelf"><a href="#readelf" class="headerlink" title="readelf"></a>readelf</h2><p>这个可以作为nm, objdump的升级版; 一般用好这个另外的可以不用.</p>
<blockquote>
<p>这个程序和objdump提供的功能类似，但是它显示的信息更为具体，并且它不依赖BFD库(BFD库是一个GNU项目，它的目标就是希望通过一种统一的接口来处理不同的目标文件)，所以即使BFD库有什么bug存在的话也不会影响到readelf程序。</p>
</blockquote>
<p>readelf命令用来显示一个或者多个elf格式的目标文件的信息. 可以支持32位, 64位的elf格式文件, 也支持包含elf文件的文档(这里一般指的是使用ar命令将一些elf文件打包之后生成的例如lib*.a之类的“静态库”文件)</p>
<p>readelf包含3类文件:(通过elf头文件可以查看文件类型, readelf -h)</p>
<ul>
<li>.a文件或者其他中间文件.o (可重定relocatable文件)</li>
<li>编译好的可以直接载入内存的可执行文件(最终可执行文件)</li>
<li>共享目标文件(动态库DYN relocatable文件)</li>
</ul>
<p>可以看出来平常使用编译链接的文件都称为可执行文件, 它们的区别在于:</p>
<ul>
<li>如果用于编译和链接(可重定位文件)，则编译器和链接器将把elf文件看作是节头表描述的节的集合,程序头表可选</li>
<li>如果用于加载执行(可执行文件)，则加载器则将把elf文件看作是程序头表描述的段的集合，一个段可能包含多个节，节头表可选(但一般都有, 多数程序运行还是需要定义变量数据等)</li>
<li>如果是共享文件，则两者都含有</li>
</ul>
<p>区别<code>程序头表(program)</code>和<code>节(section, segment)头表</code>解释:</p>
<ul>
<li>程序头(也就是program)和程序运行, 载入内存映像相关, 所以一般用于可执行文件和动态库.<br>使用命令 <code>readelf -l</code></li>
<li>节头(也就是各个section, segment; 一个section可能包含多个segment)和编译, 链接, 执行都相关相关, 所以一般用于.o文件和静态库, 动态库,以及可执行文件<br>使用命令 <code>readelf -S</code>, 注意区别于-s</li>
</ul>
<p>(program程序, section节, segment段)</p>
<p>当然为了交叉编译(增加可移植性), 也会引入<code>elf</code>文件头, 声明文件类型信息, 硬件&amp;平台信息. </p>
<p>用错类型也没有关系, 因为该命令会告诉你相关内容不存在. 你可以参考一下常用命令总结:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 显示所有信息</span></div><div class="line">$ readelf <span class="_">-a</span> file_name</div><div class="line"></div><div class="line"><span class="comment"># 读取ELF文件头(elf文件的格式说明, 保证可移植性)</span></div><div class="line">$ readelf -h file_name</div><div class="line"></div><div class="line"><span class="comment"># 读取程序头program头信息(目标文件没有该表, 仅用于可执行文件和动态库文件)</span></div><div class="line">$ readelf <span class="_">-l</span> file_name</div><div class="line"></div><div class="line"><span class="comment"># 读取section头信息, 几乎用于所有文件(可执行文件和so库文件不是必须)</span></div><div class="line">$ readelf -S file_name.o</div><div class="line"></div><div class="line"><span class="comment"># 详细显示符号表(包括全局变量和函数; 即程序头里的详细内容和段节中的详细内容), 作为-S和-l的详细补充.</span></div><div class="line">$ readelf <span class="_">-s</span> file_name  (相当于nm <span class="_">-s</span> 和 objdump -t)</div></pre></td></tr></table></figure></p>
<p>(用一用就知道, readelf -s显示最详细了; 根据实际经验一般是动态库调用问题,-l和-s用的比较多, 尤其-s比较清晰)</p>
<p>详细的可以看看下面的参考:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">$ readelf -h</div><div class="line">readelf: Warning: Nothing to do.</div><div class="line">Usage: readelf &lt;option(s)&gt; elf-file(s)</div><div class="line"> Display information about the contents of ELF format files</div><div class="line"> Options are:</div><div class="line">  -a --all               Equivalent to: -h -l -S -s -r -d -V -A -I</div><div class="line">  -h --file-header       Display the ELF file header</div><div class="line">  -l --program-headers   Display the program headers</div><div class="line">     --segments          An alias for --program-headers</div><div class="line">  -S --section-headers   Display the sections&apos; header</div><div class="line">     --sections          An alias for --section-headers</div><div class="line">  -g --section-groups    Display the section groups</div><div class="line">  -t --section-details   Display the section details</div><div class="line">  -e --headers           Equivalent to: -h -l -S</div><div class="line">  -s --syms              Display the symbol table</div><div class="line">     --symbols           An alias for --syms</div><div class="line">  --dyn-syms             Display the dynamic symbol table</div><div class="line">  -n --notes             Display the core notes (if present)</div><div class="line">  -r --relocs            Display the relocations (if present)</div><div class="line">  -u --unwind            Display the unwind info (if present)</div><div class="line">  -d --dynamic           Display the dynamic section (if present)</div><div class="line">  -V --version-info      Display the version sections (if present)</div><div class="line">  -A --arch-specific     Display architecture specific information (if any).</div><div class="line">  -c --archive-index     Display the symbol/file index in an archive</div><div class="line">  -D --use-dynamic       Use the dynamic section info when displaying symbols</div><div class="line">  -x --hex-dump=&lt;number|name&gt;</div><div class="line">                         Dump the contents of section &lt;number|name&gt; as bytes</div><div class="line">  -p --string-dump=&lt;number|name&gt;</div><div class="line">                         Dump the contents of section &lt;number|name&gt; as strings</div><div class="line">  -R --relocated-dump=&lt;number|name&gt;</div><div class="line">                         Dump the contents of section &lt;number|name&gt; as relocated bytes</div><div class="line">  -w[lLiaprmfFsoRt] or</div><div class="line">  --debug-dump[=rawline,=decodedline,=info,=abbrev,=pubnames,=aranges,=macro,=frames,</div><div class="line">               =frames-interp,=str,=loc,=Ranges,=pubtypes,</div><div class="line">               =gdb_index,=trace_info,=trace_abbrev,=trace_aranges]</div><div class="line">                         Display the contents of DWARF2 debug sections</div><div class="line">  --dwarf-depth=N        Do not display DIEs at depth N or greater</div><div class="line">  --dwarf-start=N        Display DIEs starting with N, at the same depth</div><div class="line">                         or deeper</div><div class="line">  -I --histogram         Display histogram of bucket list lengths</div><div class="line">  -W --wide              Allow output width to exceed 80 characters</div><div class="line">  @&lt;file&gt;                Read options from &lt;file&gt;</div><div class="line">  -H --help              Display this information</div><div class="line">  -v --version           Display the version number of readelf</div></pre></td></tr></table></figure></p>
<p>分清楚上面关系, 直接 -a 选项重定向到一个外部文件也是可以的, 不然就使用-l和-S选项. 下面有一个案例:(直接使用-a输出的)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> global_init = <span class="number">1</span>;</div><div class="line"><span class="keyword">int</span> global_uninit;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"merlin.\n"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">int</span> local_int;</div><div class="line">  print();</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码很简单, 编译, 然后把内容导入log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ readelf -a &gt; log</div></pre></td></tr></table></figure></p>
<p>生成的log文件如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div></pre></td><td class="code"><pre><div class="line">ELF Header:</div><div class="line">  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 </div><div class="line">  Class:                             ELF64</div><div class="line">  Data:                              2&apos;s complement, little endian</div><div class="line">  Version:                           1 (current)</div><div class="line">  OS/ABI:                            UNIX - System V</div><div class="line">  ABI Version:                       0</div><div class="line">  Type:                              EXEC (Executable file)</div><div class="line">  Machine:                           Advanced Micro Devices X86-64</div><div class="line">  Version:                           0x1</div><div class="line">  Entry point address:               0x400410</div><div class="line">  Start of program headers:          64 (bytes into file)</div><div class="line">  Start of section headers:          6712 (bytes into file)</div><div class="line">  Flags:                             0x0</div><div class="line">  Size of this header:               64 (bytes)</div><div class="line">  Size of program headers:           56 (bytes)</div><div class="line">  Number of program headers:         9</div><div class="line">  Size of section headers:           64 (bytes)</div><div class="line">  Number of section headers:         35</div><div class="line">  Section header string table index: 32</div><div class="line"></div><div class="line">Section Headers:</div><div class="line">  [Nr] Name              Type             Address           Offset</div><div class="line">       Size              EntSize          Flags  Link  Info  Align</div><div class="line">  [ 0]                   NULL             0000000000000000  00000000</div><div class="line">       0000000000000000  0000000000000000           0     0     0</div><div class="line">  [ 1] .interp           PROGBITS         0000000000400238  00000238</div><div class="line">       000000000000001c  0000000000000000   A       0     0     1</div><div class="line">  [ 2] .note.ABI-tag     NOTE             0000000000400254  00000254</div><div class="line">       0000000000000020  0000000000000000   A       0     0     4</div><div class="line">  [ 3] .note.gnu.build-i NOTE             0000000000400274  00000274</div><div class="line">       0000000000000024  0000000000000000   A       0     0     4</div><div class="line">  [ 4] .gnu.hash         GNU_HASH         0000000000400298  00000298</div><div class="line">       000000000000001c  0000000000000000   A       5     0     8</div><div class="line">  [ 5] .dynsym           DYNSYM           00000000004002b8  000002b8</div><div class="line">       0000000000000060  0000000000000018   A       6     1     8</div><div class="line">  [ 6] .dynstr           STRTAB           0000000000400318  00000318</div><div class="line">       000000000000003d  0000000000000000   A       0     0     1</div><div class="line">  [ 7] .gnu.version      VERSYM           0000000000400356  00000356</div><div class="line">       0000000000000008  0000000000000002   A       5     0     2</div><div class="line">  [ 8] .gnu.version_r    VERNEED          0000000000400360  00000360</div><div class="line">       0000000000000020  0000000000000000   A       6     1     8</div><div class="line">  [ 9] .rela.dyn         RELA             0000000000400380  00000380</div><div class="line">       0000000000000018  0000000000000018   A       5     0     8</div><div class="line">  [10] .rela.plt         RELA             0000000000400398  00000398</div><div class="line">       0000000000000030  0000000000000018   A       5    12     8</div><div class="line">  [11] .init             PROGBITS         00000000004003c8  000003c8</div><div class="line">       000000000000000e  0000000000000000  AX       0     0     4</div><div class="line">  [12] .plt              PROGBITS         00000000004003e0  000003e0</div><div class="line">       0000000000000030  0000000000000010  AX       0     0     16</div><div class="line">  [13] .text             PROGBITS         0000000000400410  00000410</div><div class="line">       00000000000001d4  0000000000000000  AX       0     0     16</div><div class="line">  [14] .fini             PROGBITS         00000000004005e4  000005e4</div><div class="line">       0000000000000009  0000000000000000  AX       0     0     4</div><div class="line">  [15] .rodata           PROGBITS         00000000004005f0  000005f0</div><div class="line">       000000000000000c  0000000000000000   A       0     0     4</div><div class="line">  [16] .eh_frame_hdr     PROGBITS         00000000004005fc  000005fc</div><div class="line">       0000000000000034  0000000000000000   A       0     0     4</div><div class="line">  [17] .eh_frame         PROGBITS         0000000000400630  00000630</div><div class="line">       00000000000000c4  0000000000000000   A       0     0     8</div><div class="line">  [18] .init_array       INIT_ARRAY       0000000000600df8  00000df8</div><div class="line">       0000000000000008  0000000000000000  WA       0     0     8</div><div class="line">  [19] .fini_array       FINI_ARRAY       0000000000600e00  00000e00</div><div class="line">       0000000000000008  0000000000000000  WA       0     0     8</div><div class="line">  [20] .jcr              PROGBITS         0000000000600e08  00000e08</div><div class="line">       0000000000000008  0000000000000000  WA       0     0     8</div><div class="line">  [21] .dynamic          DYNAMIC          0000000000600e10  00000e10</div><div class="line">       00000000000001d0  0000000000000010  WA       6     0     8</div><div class="line">  [22] .got              PROGBITS         0000000000600fe0  00000fe0</div><div class="line">       0000000000000008  0000000000000008  WA       0     0     8</div><div class="line">  [23] .got.plt          PROGBITS         0000000000600fe8  00000fe8</div><div class="line">       0000000000000028  0000000000000008  WA       0     0     8</div><div class="line">  [24] .data             PROGBITS         0000000000601010  00001010</div><div class="line">       0000000000000014  0000000000000000  WA       0     0     8</div><div class="line">  [25] .bss              NOBITS           0000000000601024  00001024</div><div class="line">       000000000000000c  0000000000000000  WA       0     0     4</div><div class="line">  [26] .comment          PROGBITS         0000000000000000  00001024</div><div class="line">       000000000000005d  0000000000000001  MS       0     0     1</div><div class="line">  [27] .debug_aranges    PROGBITS         0000000000000000  00001081</div><div class="line">       0000000000000030  0000000000000000           0     0     1</div><div class="line">  [28] .debug_info       PROGBITS         0000000000000000  000010b1</div><div class="line">       000000000000037e  0000000000000000           0     0     1</div><div class="line">  [29] .debug_abbrev     PROGBITS         0000000000000000  0000142f</div><div class="line">       0000000000000127  0000000000000000           0     0     1</div><div class="line">  [30] .debug_line       PROGBITS         0000000000000000  00001556</div><div class="line">       00000000000000d4  0000000000000000           0     0     1</div><div class="line">  [31] .debug_str        PROGBITS         0000000000000000  0000162a</div><div class="line">       00000000000002c3  0000000000000001  MS       0     0     1</div><div class="line">  [32] .shstrtab         STRTAB           0000000000000000  000018ed</div><div class="line">       0000000000000148  0000000000000000           0     0     1</div><div class="line">  [33] .symtab           SYMTAB           0000000000000000  000022f8</div><div class="line">       00000000000006d8  0000000000000018          34    50     8</div><div class="line">  [34] .strtab           STRTAB           0000000000000000  000029d0</div><div class="line">       0000000000000266  0000000000000000           0     0     1</div><div class="line">Key to Flags:</div><div class="line">  W (write), A (alloc), X (execute), M (merge), S (strings), l (large)</div><div class="line">  I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown)</div><div class="line">  O (extra OS processing required) o (OS specific), p (processor specific)</div><div class="line"></div><div class="line">There are no section groups in this file.</div><div class="line"></div><div class="line">Program Headers:</div><div class="line">  Type           Offset             VirtAddr           PhysAddr</div><div class="line">                 FileSiz            MemSiz              Flags  Align</div><div class="line">  PHDR           0x0000000000000040 0x0000000000400040 0x0000000000400040</div><div class="line">                 0x00000000000001f8 0x00000000000001f8  R E    8</div><div class="line">  INTERP         0x0000000000000238 0x0000000000400238 0x0000000000400238</div><div class="line">                 0x000000000000001c 0x000000000000001c  R      1</div><div class="line">      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]</div><div class="line">  LOAD           0x0000000000000000 0x0000000000400000 0x0000000000400000</div><div class="line">                 0x00000000000006f4 0x00000000000006f4  R E    200000</div><div class="line">  LOAD           0x0000000000000df8 0x0000000000600df8 0x0000000000600df8</div><div class="line">                 0x000000000000022c 0x0000000000000238  RW     200000</div><div class="line">  DYNAMIC        0x0000000000000e10 0x0000000000600e10 0x0000000000600e10</div><div class="line">                 0x00000000000001d0 0x00000000000001d0  RW     8</div><div class="line">  NOTE           0x0000000000000254 0x0000000000400254 0x0000000000400254</div><div class="line">                 0x0000000000000044 0x0000000000000044  R      4</div><div class="line">  GNU_EH_FRAME   0x00000000000005fc 0x00000000004005fc 0x00000000004005fc</div><div class="line">                 0x0000000000000034 0x0000000000000034  R      4</div><div class="line">  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000</div><div class="line">                 0x0000000000000000 0x0000000000000000  RW     8</div><div class="line">  GNU_RELRO      0x0000000000000df8 0x0000000000600df8 0x0000000000600df8</div><div class="line">                 0x0000000000000208 0x0000000000000208  R      1</div><div class="line"></div><div class="line"> Section to Segment mapping:</div><div class="line">  Segment Sections...</div><div class="line">   00     </div><div class="line">   01     .interp </div><div class="line">   02     .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr </div><div class="line">          .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .text </div><div class="line">          .fini .rodata .eh_frame_hdr .eh_frame </div><div class="line">   03     .init_array .fini_array .jcr .dynamic .got .got.plt .data .bss </div><div class="line">   04     .dynamic </div><div class="line">   05     .note.ABI-tag .note.gnu.build-id </div><div class="line">   06     .eh_frame_hdr </div><div class="line">   07     </div><div class="line">   08     .init_array .fini_array .jcr .dynamic .got </div><div class="line"></div><div class="line">Dynamic section at offset 0xe10 contains 24 entries:</div><div class="line">  Tag        Type                         Name/Value</div><div class="line"> 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]</div><div class="line"> 0x000000000000000c (INIT)               0x4003c8</div><div class="line"> 0x000000000000000d (FINI)               0x4005e4</div><div class="line"> 0x0000000000000019 (INIT_ARRAY)         0x600df8</div><div class="line"> 0x000000000000001b (INIT_ARRAYSZ)       8 (bytes)</div><div class="line"> 0x000000000000001a (FINI_ARRAY)         0x600e00</div><div class="line"> 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes)</div><div class="line"> 0x000000006ffffef5 (GNU_HASH)           0x400298</div><div class="line"> 0x0000000000000005 (STRTAB)             0x400318</div><div class="line"> 0x0000000000000006 (SYMTAB)             0x4002b8</div><div class="line"> 0x000000000000000a (STRSZ)              61 (bytes)</div><div class="line"> 0x000000000000000b (SYMENT)             24 (bytes)</div><div class="line"> 0x0000000000000015 (DEBUG)              0x0</div><div class="line"> 0x0000000000000003 (PLTGOT)             0x600fe8</div><div class="line"> 0x0000000000000002 (PLTRELSZ)           48 (bytes)</div><div class="line"> 0x0000000000000014 (PLTREL)             RELA</div><div class="line"> 0x0000000000000017 (JMPREL)             0x400398</div><div class="line"> 0x0000000000000007 (RELA)               0x400380</div><div class="line"> 0x0000000000000008 (RELASZ)             24 (bytes)</div><div class="line"> 0x0000000000000009 (RELAENT)            24 (bytes)</div><div class="line"> 0x000000006ffffffe (VERNEED)            0x400360</div><div class="line"> 0x000000006fffffff (VERNEEDNUM)         1</div><div class="line"> 0x000000006ffffff0 (VERSYM)             0x400356</div><div class="line"> 0x0000000000000000 (NULL)               0x0</div><div class="line"></div><div class="line">Relocation section &apos;.rela.dyn&apos; at offset 0x380 contains 1 entries:</div><div class="line">  Offset          Info           Type           Sym. Value    Sym. Name + Addend</div><div class="line">000000600fe0  000300000006 R_X86_64_GLOB_DAT 0000000000000000 __gmon_start__ + 0</div><div class="line"></div><div class="line">Relocation section &apos;.rela.plt&apos; at offset 0x398 contains 2 entries:</div><div class="line">  Offset          Info           Type           Sym. Value    Sym. Name + Addend</div><div class="line">000000601000  000100000007 R_X86_64_JUMP_SLO 0000000000000000 puts + 0</div><div class="line">000000601008  000200000007 R_X86_64_JUMP_SLO 0000000000000000 __libc_start_main + 0</div><div class="line"></div><div class="line">There are no unwind sections in this file.</div><div class="line"></div><div class="line">Symbol table &apos;.dynsym&apos; contains 4 entries:</div><div class="line">   Num:    Value          Size Type    Bind   Vis      Ndx Name</div><div class="line">     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND </div><div class="line">     1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)</div><div class="line">     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (2)</div><div class="line">     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__</div><div class="line"></div><div class="line">Symbol table &apos;.symtab&apos; contains 73 entries:</div><div class="line">   Num:    Value          Size Type    Bind   Vis      Ndx Name</div><div class="line">     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND </div><div class="line">     1: 0000000000400238     0 SECTION LOCAL  DEFAULT    1 </div><div class="line">     2: 0000000000400254     0 SECTION LOCAL  DEFAULT    2 </div><div class="line">     3: 0000000000400274     0 SECTION LOCAL  DEFAULT    3 </div><div class="line">     4: 0000000000400298     0 SECTION LOCAL  DEFAULT    4 </div><div class="line">     5: 00000000004002b8     0 SECTION LOCAL  DEFAULT    5 </div><div class="line">     6: 0000000000400318     0 SECTION LOCAL  DEFAULT    6 </div><div class="line">     7: 0000000000400356     0 SECTION LOCAL  DEFAULT    7 </div><div class="line">     8: 0000000000400360     0 SECTION LOCAL  DEFAULT    8 </div><div class="line">     9: 0000000000400380     0 SECTION LOCAL  DEFAULT    9 </div><div class="line">    10: 0000000000400398     0 SECTION LOCAL  DEFAULT   10 </div><div class="line">    11: 00000000004003c8     0 SECTION LOCAL  DEFAULT   11 </div><div class="line">    12: 00000000004003e0     0 SECTION LOCAL  DEFAULT   12 </div><div class="line">    13: 0000000000400410     0 SECTION LOCAL  DEFAULT   13 </div><div class="line">    14: 00000000004005e4     0 SECTION LOCAL  DEFAULT   14 </div><div class="line">    15: 00000000004005f0     0 SECTION LOCAL  DEFAULT   15 </div><div class="line">    16: 00000000004005fc     0 SECTION LOCAL  DEFAULT   16 </div><div class="line">    17: 0000000000400630     0 SECTION LOCAL  DEFAULT   17 </div><div class="line">    18: 0000000000600df8     0 SECTION LOCAL  DEFAULT   18 </div><div class="line">    19: 0000000000600e00     0 SECTION LOCAL  DEFAULT   19 </div><div class="line">    20: 0000000000600e08     0 SECTION LOCAL  DEFAULT   20 </div><div class="line">    21: 0000000000600e10     0 SECTION LOCAL  DEFAULT   21 </div><div class="line">    22: 0000000000600fe0     0 SECTION LOCAL  DEFAULT   22 </div><div class="line">    23: 0000000000600fe8     0 SECTION LOCAL  DEFAULT   23 </div><div class="line">    24: 0000000000601010     0 SECTION LOCAL  DEFAULT   24 </div><div class="line">    25: 0000000000601024     0 SECTION LOCAL  DEFAULT   25 </div><div class="line">    26: 0000000000000000     0 SECTION LOCAL  DEFAULT   26 </div><div class="line">    27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27 </div><div class="line">    28: 0000000000000000     0 SECTION LOCAL  DEFAULT   28 </div><div class="line">    29: 0000000000000000     0 SECTION LOCAL  DEFAULT   29 </div><div class="line">    30: 0000000000000000     0 SECTION LOCAL  DEFAULT   30 </div><div class="line">    31: 0000000000000000     0 SECTION LOCAL  DEFAULT   31 </div><div class="line">    32: 000000000040043c     0 FUNC    LOCAL  DEFAULT   13 call_gmon_start</div><div class="line">    33: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c</div><div class="line">    34: 0000000000600e08     0 OBJECT  LOCAL  DEFAULT   20 __JCR_LIST__</div><div class="line">    35: 0000000000400460     0 FUNC    LOCAL  DEFAULT   13 deregister_tm_clones</div><div class="line">    36: 00000000004004a0     0 FUNC    LOCAL  DEFAULT   13 register_tm_clones</div><div class="line">    37: 00000000004004e0     0 FUNC    LOCAL  DEFAULT   13 __do_global_dtors_aux</div><div class="line">    38: 0000000000601024     1 OBJECT  LOCAL  DEFAULT   25 completed.7516</div><div class="line">    39: 0000000000600e00     0 OBJECT  LOCAL  DEFAULT   19 __do_global_dtors_aux_fin</div><div class="line">    40: 0000000000400500     0 FUNC    LOCAL  DEFAULT   13 frame_dummy</div><div class="line">    41: 0000000000600df8     0 OBJECT  LOCAL  DEFAULT   18 __frame_dummy_init_array_</div><div class="line">    42: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS main.c</div><div class="line">    43: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c</div><div class="line">    44: 00000000004006f0     0 OBJECT  LOCAL  DEFAULT   17 __FRAME_END__</div><div class="line">    45: 0000000000600e08     0 OBJECT  LOCAL  DEFAULT   20 __JCR_END__</div><div class="line">    46: 0000000000600e00     0 NOTYPE  LOCAL  DEFAULT   18 __init_array_end</div><div class="line">    47: 0000000000600e10     0 OBJECT  LOCAL  DEFAULT   21 _DYNAMIC</div><div class="line">    48: 0000000000600df8     0 NOTYPE  LOCAL  DEFAULT   18 __init_array_start</div><div class="line">    49: 0000000000600fe8     0 OBJECT  LOCAL  DEFAULT   23 _GLOBAL_OFFSET_TABLE_</div><div class="line">    50: 00000000004005e0     2 FUNC    GLOBAL DEFAULT   13 __libc_csu_fini</div><div class="line">    51: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab</div><div class="line">    52: 0000000000601010     0 NOTYPE  WEAK   DEFAULT   24 data_start</div><div class="line">    53: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@@GLIBC_2.2.5</div><div class="line">    54: 0000000000601028     4 OBJECT  GLOBAL DEFAULT   25 global_uninit</div><div class="line">    55: 0000000000601024     0 NOTYPE  GLOBAL DEFAULT  ABS _edata</div><div class="line">    56: 00000000004005e4     0 FUNC    GLOBAL DEFAULT   14 _fini</div><div class="line">    57: 0000000000601020     4 OBJECT  GLOBAL DEFAULT   24 global_init</div><div class="line">    58: 0000000000400528    17 FUNC    GLOBAL DEFAULT   13 print</div><div class="line">    59: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_</div><div class="line">    60: 0000000000601010     0 NOTYPE  GLOBAL DEFAULT   24 __data_start</div><div class="line">    61: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__</div><div class="line">    62: 0000000000601018     0 OBJECT  GLOBAL HIDDEN    24 __dso_handle</div><div class="line">    63: 00000000004005f0     4 OBJECT  GLOBAL DEFAULT   15 _IO_stdin_used</div><div class="line">    64: 0000000000400550   137 FUNC    GLOBAL DEFAULT   13 __libc_csu_init</div><div class="line">    65: 0000000000601030     0 NOTYPE  GLOBAL DEFAULT  ABS _end</div><div class="line">    66: 0000000000400410     0 FUNC    GLOBAL DEFAULT   13 _start</div><div class="line">    67: 0000000000601024     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start</div><div class="line">    68: 0000000000400539    21 FUNC    GLOBAL DEFAULT   13 main</div><div class="line">    69: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses</div><div class="line">    70: 0000000000601028     0 OBJECT  GLOBAL HIDDEN    24 __TMC_END__</div><div class="line">    71: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable</div><div class="line">    72: 00000000004003c8     0 FUNC    GLOBAL DEFAULT   11 _init</div><div class="line"></div><div class="line">Version symbols section &apos;.gnu.version&apos; contains 4 entries:</div><div class="line"> Addr: 0000000000400356  Offset: 0x000356  Link: 5 (.dynsym)</div><div class="line">  000:   0 (*local*)       2 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)   0 (*local*)    </div><div class="line"></div><div class="line">Version needs section &apos;.gnu.version_r&apos; contains 1 entries:</div><div class="line"> Addr: 0x0000000000400360  Offset: 0x000360  Link: 6 (.dynstr)</div><div class="line">  000000: Version: 1  File: libc.so.6  Cnt: 1</div><div class="line">  0x0010:   Name: GLIBC_2.2.5  Flags: none  Version: 2</div><div class="line"></div><div class="line">Notes at offset 0x00000254 with length 0x00000020:</div><div class="line">  Owner                 Data size      Description</div><div class="line">  GNU                  0x00000010      NT_GNU_ABI_TAG (ABI version tag)</div><div class="line">    OS: Linux, ABI: 2.6.24</div><div class="line"></div><div class="line">Notes at offset 0x00000274 with length 0x00000024:</div><div class="line">  Owner                 Data size      Description</div><div class="line">  GNU                  0x00000014      NT_GNU_BUILD_ID (unique build ID bitstring)</div><div class="line">    Build ID: 5109749eee8bf3101f1f0cb4be9432d7385ce1bf</div></pre></td></tr></table></figure></p>
<p>其实还是比较详细的, 例如寻找全局变量, 可以查看<code>.symtab</code>的data部分<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">52: 0000000000601010     0 NOTYPE  WEAK   DEFAULT   24 data_start</div><div class="line">53: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@@GLIBC_2.2.5</div><div class="line">54: 0000000000601028     4 OBJECT  GLOBAL DEFAULT   25 global_uninit</div><div class="line">55: 0000000000601024     0 NOTYPE  GLOBAL DEFAULT  ABS _edata</div><div class="line">56: 00000000004005e4     0 FUNC    GLOBAL DEFAULT   14 _fini</div><div class="line">57: 0000000000601020     4 OBJECT  GLOBAL DEFAULT   24 global_init</div><div class="line">58: 0000000000400528    17 FUNC    GLOBAL DEFAULT   13 print</div></pre></td></tr></table></figure></p>
<p>解释一下 <code>-S</code>的段头信息:</p>
<ul>
<li>.text：已编译程序的机器代码</li>
<li>.rodata：只读数据，比如printf语句中的格式串和开关（switch）语句的跳转表。</li>
<li>.data：已初始化的全局C变量。局部C变量在运行时被保存在栈中，既不出现在.data中，也不出现在.bss节中。</li>
<li>.bss：未初始化的全局变量. 在目标文件中这个节不占据实际的空间，它仅仅是一个占位符。目标文件格式区分初始化和未初始化变量是为了空间效率在：在目标文件中，未初始化变量不需要占据任何实际的磁盘空间。</li>
<li>.symtab：一个符号表（symbol table），它存放在程序中被定义和引用的函数和<code>全局变量的信息</code>。一些程序员错误地认为必须通过-g选项来编译一个程序，得到符号表信息。实际上，每个可重定位目标文件在.symtab中都有一张符号表。然而，和编译器中的符号表不同，.symtab符号表不包含局部变量的表目</li>
<li>.rel.text：rel代表relocate, 需要重定向. 当链接噐把这个目标文件和其他文件结合时，.text节中的许多位置都需要修改。一般而言，任何调用外部函数或者引用全局变量的指令都需要修改另一方面调用本地函数的指令则不需要修改. 注意可执行目标文件中并不需要重定位信息, 通常省略(不太显示这些信息), 除非使用者显式地指示链接器包含这些信息.</li>
<li>.rel.data：被模块定义或引用的任何全局变量的信息。一般而言，任何已初始化全局变量的初始值是全局变量或者外部定义函数的地址都需要被修改</li>
<li>.debug：一个调试符号表，其有些表目是程序中定义的局部变量和类型定义，有些表目是程序中定义和引用的全局变量, 有些是原始的C源文件. 只有以-g选项调用编译驱动程序时，才会得到这张表</li>
<li>.line:原始C源程序中的行号和.text节中机器指令之间的映射。只有以-g选项调用编译驱动程序时，才会得到这张表</li>
<li>.strtab: 一个字符串表，其内容包括.symtab和.debug节中的符号表以及节头部中的节名字, 字符串表就是以null结尾的字符串序列</li>
</ul>
<h2 id="ranlib"><a href="#ranlib" class="headerlink" title="ranlib"></a>ranlib</h2><p>参考上面的 <code>ar s</code>命令, 略.</p>
<h2 id="size"><a href="#size" class="headerlink" title="size"></a>size</h2><p>列出目标文件每一个段(segment)的大小和总的大小, 例如:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ size main</div><div class="line">   text	   data	    bss	    dec	    hex	filename</div><div class="line">   1192	       556       12    1760     6e0	main</div></pre></td></tr></table></figure></p>
<p>当然也可以指定格式 <code>--format=Berkeley</code>(默认) 或者 <code>--format=SysV</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">$ size --format=SysV main</div><div class="line">main  :</div><div class="line">section              size      addr</div><div class="line">.interp                28   4194872</div><div class="line">.note.ABI-tag          32   4194900</div><div class="line">.note.gnu.build-id     36   4194932</div><div class="line">.gnu.hash              28   4194968</div><div class="line">.dynsym                96   4195000</div><div class="line">.dynstr                61   4195096</div><div class="line">.gnu.version            8   4195158</div><div class="line">.gnu.version_r         32   4195168</div><div class="line">.rela.dyn              24   4195200</div><div class="line">.rela.plt              48   4195224</div><div class="line">.init                  14   4195272</div><div class="line">.plt                   48   4195296</div><div class="line">.text                 468   4195344</div><div class="line">.fini                   9   4195812</div><div class="line">.rodata                12   4195824</div><div class="line">.eh_frame_hdr          52   4195836</div><div class="line">.eh_frame             196   4195888</div><div class="line">.init_array             8   6295032</div><div class="line">.fini_array             8   6295040</div><div class="line">.jcr                    8   6295048</div><div class="line">.dynamic              464   6295056</div><div class="line">.got                    8   6295520</div><div class="line">.got.plt               40   6295528</div><div class="line">.data                  20   6295568</div><div class="line">.bss                   12   6295588</div><div class="line">.comment               93         0</div><div class="line">.debug_aranges         48         0</div><div class="line">.debug_info           894         0</div><div class="line">.debug_abbrev         295         0</div><div class="line">.debug_line           212         0</div><div class="line">.debug_str            707         0</div><div class="line">Total                4009</div></pre></td></tr></table></figure>
<h2 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h2><p>列出目标文件中的字符串或者可打印的内容, strings is mainly useful for determining the contents of non-text files.</p>
<p>也就是说, 如果一个文件不是文本文件, 你想查看它的内容, 怎么搞? 那你就用strings大致看一下内容吧:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$ strings main.o</div><div class="line">$ strings main</div><div class="line"></div><div class="line"><span class="comment">#### 例如 ####</span></div><div class="line">$ strings main.c</div><div class="line"><span class="comment">#include &lt;stdio.h&gt;</span></div><div class="line">int global_init = 1;</div><div class="line">int global_uninit;</div><div class="line">void <span class="built_in">print</span>()</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"merlin.\n"</span>);</div><div class="line">int main(void)</div><div class="line">  int local_int;</div><div class="line">  <span class="built_in">print</span>();</div><div class="line">  <span class="built_in">return</span> 0;</div></pre></td></tr></table></figure></p>
<p>个人一般不用这个命令.</p>
<h2 id="strip"><a href="#strip" class="headerlink" title="strip"></a>strip</h2><p>去除目标文件中的所有符号(使目标文件尺寸减小), 但是你调试的时候最好别去除符号信息(你排错的时候, 调试信息和源码的行数很难知道对应关系了).</p>
<p>例如你在调试线程文件的时候, 使用的是strip过的pthread库, 那么gdb在加载的时候, pthread.c内部就会报错, 如果你换一个没有strip的pthread库文件, 那么gdb加载该可执行文件才不会报错.</p>
<p>举个案例吧:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ ls <span class="_">-l</span> main</div><div class="line">-rwxrwxr-x 1 merlin merlin 11318 Aug 30 20:56 main</div><div class="line">$ strip main</div><div class="line">$ ls <span class="_">-l</span> main</div><div class="line">-rwxrwxr-x 1 merlin merlin 6272 Aug 30 21:12 main</div></pre></td></tr></table></figure>
<h1 id="尾巴"><a href="#尾巴" class="headerlink" title="尾巴"></a>尾巴</h1><p>虽然binutils里的工具, 不如三大件儿 make, gcc, gdb那么强大, 但是日常用到的也不少, 特别是debug定位位置的时候.</p>
<hr>
<p>who is sponsoring the site? - i shall say merlin (<code>wizardmerlin945@gmail.com</code>)<br>欢迎发邮件给我(生活问题，请高抬贵手)</p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2017/07/01/lambda-in-cpp.html" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2017/07/01/thread-poll-model-again.html" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2017-07-01 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/codings/">codings<span>60</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/linux/">linux<span>9</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#引子"><span class="toc-article-text">引子</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#正文"><span class="toc-article-text">正文</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#ar"><span class="toc-article-text">ar</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#ld"><span class="toc-article-text">ld</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#nm"><span class="toc-article-text">nm</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#objdump"><span class="toc-article-text">objdump</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#readelf"><span class="toc-article-text">readelf</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#ranlib"><span class="toc-article-text">ranlib</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#size"><span class="toc-article-text">size</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#strings"><span class="toc-article-text">strings</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#strip"><span class="toc-article-text">strip</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#尾巴"><span class="toc-article-text">尾巴</span></a></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2017 MerlinYu
  
     
     <br> Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind.386</a>.    
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
