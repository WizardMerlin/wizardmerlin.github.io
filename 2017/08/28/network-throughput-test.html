<!DOCTYPE html>
<html>
<head>

  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="/css/fonts.css" />
  <link rel="stylesheet" href="//cdn.bootcss.com/bulma/0.4.1/css/bulma.min.css"> 
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  
  <title>网络吞吐量测试 | Merlin&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="主要使用nc测试一下网络吞吐量(throughput), 辅助工具time, pv, dd, nc">
<meta name="keywords" content="网络">
<meta property="og:type" content="article">
<meta property="og:title" content="网络吞吐量测试">
<meta property="og:url" content="www.merlinblog.site/2017/08/28/network-throughput-test.html">
<meta property="og:site_name" content="Merlin&#39;s Blog">
<meta property="og:description" content="主要使用nc测试一下网络吞吐量(throughput), 辅助工具time, pv, dd, nc">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://omotkhw3y.bkt.clouddn.com/throughput1.jpg">
<meta property="og:image" content="http://omotkhw3y.bkt.clouddn.com/dd-nc-first.png">
<meta property="og:image" content="http://omotkhw3y.bkt.clouddn.com/dd-nc-first1.jpg">
<meta property="og:image" content="http://omotkhw3y.bkt.clouddn.com/time-nc.png">
<meta property="og:image" content="http://omotkhw3y.bkt.clouddn.com/time-nc1.jpg">
<meta property="og:image" content="http://omotkhw3y.bkt.clouddn.com/nc_dd.jpg">
<meta property="og:updated_time" content="2017-09-28T12:43:04.319Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="网络吞吐量测试">
<meta name="twitter:description" content="主要使用nc测试一下网络吞吐量(throughput), 辅助工具time, pv, dd, nc">
<meta name="twitter:image" content="http://omotkhw3y.bkt.clouddn.com/throughput1.jpg">
  
  
    <link href="/favicon.ico" rel="ico" />
  
  
  <link rel="stylesheet" href="/css/common.css">
<link rel="stylesheet" href="/css/nav.css">
<link rel="stylesheet" href="/css/layout.css">
  

</head>

<body>

  <div class="preloader">
    <div class="preloader-inner">
      <ul><li></li><li></li><li></li><li></li><li></li><li></li></ul>
    </div>
  </div>
  <div>
	<header id="navbar" class="overflow-hidden">
  <div class="container">

    <nav class="nav">

         <div class="nav-left">
            <a href="/" class="nav-item" style="font-size: 20px;">
              <span class="logo">Merlin</span>'s Blog
            </a>
           <span style="margin-top:20px; font-size:0.85em; color:grey;">
		      version: 2.0
		   </span>
         </div>




        <div class="nav-right nav-menu">
            <a class="nav-item" id="search" onclick="tmpfobid()">
                <i class="fa fa-search" aria-hidden="true"></i>
            </a>
            
            <a class="nav-item" href="/">
                主页
            </a>
            
            <a class="nav-item" href="/tags">
                标签集合
            </a>
            
            <a class="nav-item" href="/works">
                开源作品
            </a>
            
            <a class="nav-item" href="/about">
                关于博主
            </a>
            
            <a class="nav-item" href="/atom.xml">
                Rss
            </a>
            
        </div>

        <span class="nav-toggle" id="navMenuDropdown">
            <span></span>
            <span></span>
            <span></span>
        </span>

        <div class="navbar-menu position-absolute full-width content-box is-hidden-desktop is-flex flex-column center" style="top: 100%;">
            
            <a class="nav-item flex-1" href="/">
                主页
            </a>
            
            <a class="nav-item flex-1" href="/tags">
                标签集合
            </a>
            
            <a class="nav-item flex-1" href="/works">
                开源作品
            </a>
            
            <a class="nav-item flex-1" href="/about">
                关于博主
            </a>
            
            <a class="nav-item flex-1" href="/atom.xml">
                Rss
            </a>
            
        </div>

    </nav>
  </div>
</header>

<script>
function tmpfobid()
{
	alert("搜索效果太差, 暂时禁用 Local Search.");
}
</script>

  </div>
  <div id="main-wrap" class="position-relative" style="margin-top: 55px;">
      <div class="main-inner-content">
          <!--博文页面-->

<style>
    .header-box {
        height: 170px;
        filter: blur(10px);
        background-size: cover;
        background-color: darkgrey;
    }

    .post-box {
        padding: 15px;
        padding-top: 60px;
        min-height: 80vh;
        margin-top: -200px;
        border-radius: 4px;
        background-color: rgba(255,255,255,0.7);
    }

    .post-avatar {
        height: 30px;
        width: 30px;
        border-radius: 50%;
    }

    .flow-chart {
        text-align: center;
    }

    img[alt="post-cover"] {
        display: none;
    }
</style>





<header>
    <div id="header_box" class="header-box"></div>
</header>


<section>
<!--这里添加toc内容, 一定是在article entry之前-->
<link rel="stylesheet" href="/css/toc.css">


       <p class="show-toc-btn" id="show-toc-btn"  style="display:none" onclick="showToc()">
       <span class="btn-bg"></span>
       <span class="btn-text">文章导航</span></p>

	<div id="toc-article" class="toc-article">
	    <div id="toc-close" class="toc-close" title="隐藏导航" onclick="showBtn();">
		×
		</div>
		<strong class="toc-title"> 目录</strong>
           	<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#概念梳理"><span class="toc-number">1.</span> <span class="toc-text">概念梳理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#带宽"><span class="toc-number">1.1.</span> <span class="toc-text">带宽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#传输速率"><span class="toc-number">1.2.</span> <span class="toc-text">传输速率</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#吞吐量"><span class="toc-number">1.3.</span> <span class="toc-text">吞吐量</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#工具介绍"><span class="toc-number">2.</span> <span class="toc-text">工具介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#正式测量"><span class="toc-number">3.</span> <span class="toc-text">正式测量</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#为啥要测试"><span class="toc-number">3.1.</span> <span class="toc-text">为啥要测试?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一般测试方法"><span class="toc-number">3.2.</span> <span class="toc-text">一般测试方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实际测量"><span class="toc-number">3.3.</span> <span class="toc-text">实际测量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dd-nc"><span class="toc-number">3.3.1.</span> <span class="toc-text">dd+nc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#time-nc"><span class="toc-number">3.3.2.</span> <span class="toc-text">time+nc</span></a></li></ol></li></ol></li></ol>
    	</div>
	




<script  language="javascript">


</script>


    <div class="container post-box">
        <div class="content post-title is-flex center flex-column" style="margin-bottom: 2px; overflow: auto;">
            <div class="has-text-centered" style="font-size:36px; padding-bottom: 7px; border-bottom: 2px solid #000">
                <strong>网络吞吐量测试</strong>
            </div>
 
            <div class="is-flex align-center" style="margin-top:10px;">
                <span style="padding:0 10px;">post time:</span>
				
                <span class="post-date">2017-08-28</span>
            </div>
			
            
                <div>
                    
                         <a style="margin-right:5px" class="tag is-post-tag" href="/tags/网络/">网络</a>
                    
                </div>
            
        </div>
        <hr/>           


        <div class="content" style="overflow: auto; align:center;">
            <p>本文结合网络编程&amp;工作中, 常用的命令, 测试一下<code>网络吞吐量</code>.</p>
<blockquote>
<p>我自己也是很长一段时间搞不清楚<code>TPS</code>, <code>QPS</code>, <code>吞吐量</code>等关系; 并且总是听别人说高性能, 但是不知道所谓的高性能是主观臆测的还是测量出来的</p>
</blockquote>
<p>先来一张有趣的图.</p>
<p><img src="http://omotkhw3y.bkt.clouddn.com/throughput1.jpg" alt=""></p>
<h1 id="概念梳理"><a href="#概念梳理" class="headerlink" title="概念梳理"></a>概念梳理</h1><p>注意一下<code>带宽</code>, <code>传输速率</code>常常和<code>吞吐量</code>扯在一起, 下面先区分一下它们. </p>
<h2 id="带宽"><a href="#带宽" class="headerlink" title="带宽"></a>带宽</h2><p>定义：计算机网络中的主机在数字信道上，单位时间内从一段传送到另一端的最大数据量，即<code>最大速率</code>, <code>Max net bit rate</code><br>类比：一个供水管，假设管子中有流动的水，这里的水为数据。单位时间内，从管子的某个横截面就是速率，即单位时间内传送的数据量。当管子充满水的时候，管子的某个横截面就是最大速率，即带宽<br>单位：<code>bps</code>, 和<code>速率</code>一样, 注意是<code>b</code>,p<code>,</code>s` (bits per second).</p>
<p>1Byte=8bit, 即<code>1字节=8比特</code>， 所以<code>1Bps=8bps</code>.</p>
<blockquote>
<p>网络带宽为100Mbps, 但是我们性能测试出来的吞吐量却只有10MB多一点, 就是因为单位不同: 100Mbps的带宽实际上传输速率为12.5MB/s </p>
<blockquote>
<p>区分<code>Mbps</code>和<code>MBps</code></p>
</blockquote>
</blockquote>
<p>以前家里电信网是4M的, 4M的理论下载速度为500KB/S，实际速率只能达到200-440KB/S.</p>
<h2 id="传输速率"><a href="#传输速率" class="headerlink" title="传输速率"></a>传输速率</h2><blockquote>
<p>我们平常说的速率是<code>额定速率</code></p>
</blockquote>
<p>定义：在数据传输中，两个设备之间数据流动的物理速度成为传输速率，单位为bps<br>单位：比特是数据量最小单位，秒是时间的最小单位， 所以速率单位为bps, 类似的，有<code>kb/s</code>，<code>Mb/s</code>(M=10^6),<code>Gb/s</code>（G=10^9）,<code>Tb/s</code>(t=10^12)</p>
<blockquote>
<p>上面的单位都是<code>bit</code>, 比特.</p>
<blockquote>
<p>通常, 你把带宽理解成传输速率是不错的, 但不准确;但是反过来说传输速率是带宽就不对了.</p>
</blockquote>
</blockquote>
<p>各种传输媒介中信号的流动速度是恒定的，即使数据链路的传输速率不同，也不会出现忽快忽慢的情况。传输速率不是指单位数据流动的速度有多快，而是指单位时间内传输的数据量有多少。<br>以我们生活中的道路交通为例，低速数据链路如同车道较少无法让很多车同时通过的情况，与之相反，高速数据链路就相当于有多个车道，一次允许更多车辆行驶的道路。</p>
<blockquote>
<p>理论上说, 带宽越大网络传输能力就越强, 因为上限拉大了.</p>
</blockquote>
<h2 id="吞吐量"><a href="#吞吐量" class="headerlink" title="吞吐量"></a>吞吐量</h2><p>理论不等于实际, <code>吞吐量</code>, throuhgput就是<code>实际传输速率</code>. 你可以从它的单位可以看出来<code>bps</code>, 但是, 吞吐量不仅衡量带宽，同时也衡量主机的CPU处理能力、网络的拥堵程度等.</p>
<blockquote>
<p>说的通俗一点，就是单位时间内某个（端口）实际的数据量</p>
</blockquote>
<p>上面的内容都和速率有关. 下面的概念和<code>事务</code>, ``</p>
<h1 id="工具介绍"><a href="#工具介绍" class="headerlink" title="工具介绍"></a>工具介绍</h1><p>可以参考我的文章 <a href="www.merlinblog.site/2017/08/23/net-work-tools.html">net-work-tools</a></p>
<h1 id="正式测量"><a href="#正式测量" class="headerlink" title="正式测量"></a>正式测量</h1><h2 id="为啥要测试"><a href="#为啥要测试" class="headerlink" title="为啥要测试?"></a>为啥要测试?</h2><p>当我们讨论通信链路的带宽时，一般是指链路上每秒所能传送的比特数，它取决于链路时钟速率和信道编码在计算机网络中又称为线速。我们可以说以太网的带宽是10Mbps。但是，我们需要区分链路上的可用带宽（带宽）与实际链路中每秒所能传送的比特数（吞吐量）。我们倾向于用“吞吐量”一次来表示一个系统的测试性能。这样，因为实现受各种低效率因素的影响，所以由一段带宽为10Mbps的链路连接的一对节点可能只达到2Mbps的吞吐量。这样就意味着，一个主机上的应用能够以2Mbps的速度向另外的一个主机发送数据。</p>
<p>数据吞吐量 就是的数据包转发能力。也就是能同时转发多少数据包。也就是一个单位时间内，满负载，可以转发多少的一个数值 数据流量/秒 或者数据流量/分钟。</p>
<blockquote>
<p>简单说, 为了找出服务性能的瓶颈.</p>
</blockquote>
<h2 id="一般测试方法"><a href="#一般测试方法" class="headerlink" title="一般测试方法"></a>一般测试方法</h2><p>吞吐量的测试方法是：在测试中以一定速率发送一定数量的帧，并计算待测设备传输的帧，如果发送的帧与接收的帧数量相等，那么就将发送速率提高并重新测试；如果接收帧少于发送帧则降低发送速率重新测试，直至得出最终结果。吞吐量测试结果以比特/秒或字节/秒表示。</p>
<h2 id="实际测量"><a href="#实际测量" class="headerlink" title="实际测量"></a>实际测量</h2><blockquote>
<p>在linux平台下, 借助<code>nc</code>, <code>dd</code>, <code>time</code>等工具, 工作远没有那么复杂.</p>
</blockquote>
<p>测试环境, 本机(上海浦东金融区) –&gt; 华北(具体不知道哪)阿里云服务器, 指定端口5000</p>
<p>姑且成为, A –&gt; B 之间的测试吧, 带宽50Mbps. (阿里云的带宽应该远超50M)</p>
<p>下面开始几组测量: </p>
<h3 id="dd-nc"><a href="#dd-nc" class="headerlink" title="dd+nc"></a>dd+nc</h3><p>A也就是本机进行写(读完即舍弃):<br><img src="http://omotkhw3y.bkt.clouddn.com/dd-nc-first.png" alt=""></p>
<p>B,也就是阿里云服务器进行读:<br><img src="http://omotkhw3y.bkt.clouddn.com/dd-nc-first1.jpg" alt=""></p>
<h3 id="time-nc"><a href="#time-nc" class="headerlink" title="time+nc"></a>time+nc</h3><p>然后用time进行测试, 得出结果:</p>
<p>A端写的结果:<br><img src="http://omotkhw3y.bkt.clouddn.com/time-nc.png" alt=""></p>
<p>B端读的结果:<br><img src="http://omotkhw3y.bkt.clouddn.com/time-nc1.jpg" alt=""></p>
<blockquote>
<p>好吧, 这个结果应该是被别的因素干扰了.</p>
</blockquote>
<p>分析如下:</p>
<p>因为dd在统计时也会占用一部分资源(或者多了一次管道读写), 具体如下图:<br><img src="http://omotkhw3y.bkt.clouddn.com/nc_dd.jpg" alt=""></p>
<blockquote>
<p>此外, netcat的版本也是影响测量因素的原因, 只是这个案例中没有体现出来.</p>
</blockquote>
<hr>
<p>who is sponsoring the site? - i shall say merlin (<code>wizardmerlin945@gmail.com</code>)<br>欢迎发邮件给我(生活问题，请高抬贵手)</p>

        </div>

<!-下面是评论模块 ->
        <div class="post-reply">
            
            
        </div>

		<!-- 下面是版权声明模块-->
        
<div id="copyright" class="content blockquote">
  <blockquote>
	<span><b>版权声明</b>：本文采用<b>署名(BY)</b>-<b>非商业性使用(NC)</b>-<b>相同方式共享(SA)</b>许可协议授权,转载请注明作者及出处</span><br/>
	<span><b>本文作者</b>：<a href="/" target="_blank" title="Merlin Yu">Merlin Yu</a></span><br/>
	<span><b>本文标题</b>：网络吞吐量测试</span><br/>
	<span><b>本文链接</b>：www.merlinblog.site/2017/08/28/network-throughput-test.html</span>

  </blockquote>
</div>


    </div>
</section>

 



<script type="text/javascript">
    // 获取第一张图, 用以当封面背景图
    var img = document.querySelectorAll('img')[1]

    if (img) {
        var header_box = document.querySelector('#header_box')
        header_box.style.backgroundImage = 'url('+ img.src +')'
    }
</script>


<!-- for code block highlight --> 
<!-- theme.block_highlight -->
<!-- we do not guarantee the char sequences spell right, usr himself do it -->
<link rel="stylesheet" href="/css/highlight_rainbow.css">
<script src="/js/highlight.min.js"></script>
<script type="text/javascript"> hljs.initHighlightingOnLoad();</script>
  

<!--设置内部长度 -->                
<script type="text/javascript"> 

 $('code').attr('style', 'overflow:auto; font-size:18px; margin-left:2px; margin-right:2px;');

 
</script>






      </div>
  </div>

  <style>
  #footer {
    min-height: 10vh;
    background: black;
    color: #fff;
  }

  #footer a {
    color: #e1e1e1;
  }
</style>
<footer id="footer" class="has-text-centered is-flex center">
  <div class="container has-padding">
    <div>
      <div>
        <!--请您保留作者署名, 主题制作来之不易-->
        Copyright © <b><a href="#">Merlin Yu</a></b> 2017
        <br>
        Themed by <a href="http://haojen.github.io/">Haojen Ma</a>
		<br>
		Articles of this site licensed under <b>CC BY SA 4.0<b>
        
      </div>
    </div>
  </div>
</footer>

<script src="/js/search_core.js"></script>
<script src="/js/script.js"></script>

</body>
</html>

