<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>using-regex-in-python | Merlin&#39;s Blog</title>
  <meta name="author" content="MerlinYu">
  
  <meta name="description" content="regular expression operations in python 2.7">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="using-regex-in-python"/>
  <meta property="og:site_name" content="Merlin&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="ico">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Merlin&#39;s Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> using-regex-in-python</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> regular expression operations in python 2.7
		 </div> <!-- alert -->
	  		

	  <p>python支持正则表达式是借助外部的re库, 该库在安装python的时候就已经绑定了.<br>但是注意, 这个库是PERE的阉割版, 仅仅支持核心部分正则语法(就常用而言,足够了).<br><a id="more"></a></p>
<h1 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h1><p>本文没有像官方文档写<code>re</code>module一样去全篇幅的介绍相关的库, 而是从python开发者的角度去使用正则表达式, 当然你也可以去看文档, 其网址如下:</p>
<p><a href="https://docs.python.org/2/library/re.html" target="_blank" rel="external">https://docs.python.org/2/library/re.html</a></p>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="Raw-Python-strings"><a href="#Raw-Python-strings" class="headerlink" title="Raw Python strings"></a>Raw Python strings</h2><p>When writing regular expression in Python, it is recommended that you use raw strings instead of regular Python strings. Raw strings begin with a special prefix (r) and signal Python not to interpret backslashes and special metacharacters in the string, allowing you to pass them through directly to the regular expression engine.</p>
<p>This means that a pattern like “\n\w” will not be interpreted and can be written as r”\n\w” instead of  “\n\w” as in other languages, which is much easier to read.</p>
<h2 id="Matching-a-string"><a href="#Matching-a-string" class="headerlink" title="Matching a string"></a>Matching a string</h2><p>The re package has a number of top level methods, and to test whether a regular expression matches a specific string in Python, you can use re.search(). This method either returns None if the pattern doesn’t match, or a re.MatchObject with additional information about which part of the string the match was found.</p>
<p>Note that this method stops after the first match, so this is best suited for testing a regular expression more than extracting data.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">matchObject = re.search(pattern, input_str, flags=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># Lets use a regular expression to match a date string. Ignore</span></div><div class="line"><span class="comment"># the output since we are just testing if the regex matches.</span></div><div class="line">regex = <span class="string">r"([a-zA-Z]+) (\d+)"</span></div><div class="line"><span class="keyword">if</span> re.search(regex, <span class="string">"June 24"</span>):</div><div class="line">    <span class="comment"># Indeed, the expression "([a-zA-Z]+) (\d+)" matches the date string</span></div><div class="line">    </div><div class="line">    <span class="comment"># If we want, we can use the MatchObject's start() and end() methods </span></div><div class="line">    <span class="comment"># to retrieve where the pattern matches in the input string, and the </span></div><div class="line">    <span class="comment"># group() method to get all the matches and captured groups.</span></div><div class="line">    match = re.search(regex, <span class="string">"June 24"</span>)</div><div class="line">    </div><div class="line">    <span class="comment"># This will print [0, 7), since it matches at the beginning and end of the </span></div><div class="line">    <span class="comment"># string</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Match at index %s, %s"</span> % (match.start(), match.end())</div><div class="line">    </div><div class="line">    <span class="comment"># The groups contain the matched values.  In particular:</span></div><div class="line">    <span class="comment">#    match.group(0) always returns the fully matched string</span></div><div class="line">    <span class="comment">#    match.group(1) match.group(2), ... will return the capture</span></div><div class="line">    <span class="comment">#            groups in order from left to right in the input string</span></div><div class="line">    <span class="comment">#    match.group() is equivalent to match.group(0)</span></div><div class="line">    </div><div class="line">    <span class="comment"># So this will print "June 24"</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Full match: %s"</span> % (match.group(<span class="number">0</span>))</div><div class="line">    <span class="comment"># So this will print "June"</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Month: %s"</span> % (match.group(<span class="number">1</span>))</div><div class="line">    <span class="comment"># So this will print "24"</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Day: %s"</span> % (match.group(<span class="number">2</span>))</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    <span class="comment"># If re.search() does not match, then None is returned</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"The regex pattern does not match. :("</span></div></pre></td></tr></table></figure>
<h2 id="Capturing-groups"><a href="#Capturing-groups" class="headerlink" title="Capturing groups"></a>Capturing groups</h2><p>Unlike the re.search() method above, we can use re.findall() to perform a global search over the whole input string. If there are capture groups in the pattern, then it will return a list of all the captured data, but otherwise, it will just return a list of the matches themselves, or an empty list if no matches are found.</p>
<p>If you need additional context for each match, you can use re.finditer() which instead returns an iterator of re.MatchObjects to walk through. Both methods take the same parameters.</p>
<p>如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">matchList = re.findall(pattern, input_str, flags=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<p>以及<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">matchList = re.finditer(pattern, input_str, flags=<span class="number">0</span>)</div></pre></td></tr></table></figure></p>
<p>Example</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># Lets use a regular expression to match a few date strings.</span></div><div class="line">regex = <span class="string">r"[a-zA-Z]+ \d+"</span></div><div class="line">matches = re.findall(regex, <span class="string">"June 24, August 9, Dec 12"</span>)</div><div class="line"><span class="keyword">for</span> match <span class="keyword">in</span> matches:</div><div class="line">    <span class="comment"># This will print:</span></div><div class="line">    <span class="comment">#   June 24</span></div><div class="line">    <span class="comment">#   August 9</span></div><div class="line">    <span class="comment">#   Dec 12</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Full match: %s"</span> % (match)</div><div class="line"></div><div class="line"><span class="comment"># To capture the specific months of each date we can use the following pattern</span></div><div class="line">regex = <span class="string">r"([a-zA-Z]+) \d+"</span></div><div class="line">matches = re.findall(regex, <span class="string">"June 24, August 9, Dec 12"</span>)</div><div class="line"><span class="keyword">for</span> match <span class="keyword">in</span> matches:</div><div class="line">    <span class="comment"># This will now print:</span></div><div class="line">    <span class="comment">#   June</span></div><div class="line">    <span class="comment">#   August</span></div><div class="line">    <span class="comment">#   Dec</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Match month: %s"</span> % (match)</div><div class="line"></div><div class="line"><span class="comment"># If we need the exact positions of each match</span></div><div class="line">regex = <span class="string">r"([a-zA-Z]+) \d+"</span></div><div class="line">matches = re.finditer(regex, <span class="string">"June 24, August 9, Dec 12"</span>)</div><div class="line"><span class="keyword">for</span> match <span class="keyword">in</span> matches:</div><div class="line">    <span class="comment"># This will now print:</span></div><div class="line">    <span class="comment">#   0 7</span></div><div class="line">    <span class="comment">#   9 17</span></div><div class="line">    <span class="comment">#   19 25</span></div><div class="line">    <span class="comment"># which corresponds with the start and end of each match in the input string</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"Match at index: %s, %s"</span> % (match.start(), match.end())</div></pre></td></tr></table></figure>
<h2 id="Finding-and-replacing-strings"><a href="#Finding-and-replacing-strings" class="headerlink" title="Finding and replacing strings"></a>Finding and replacing strings</h2><p>Another common task is to find and replace a part of a string using regular expressions, for example, to replace all instances of an old email domain, or to swap the order of some text. You can do this in Python with the re.sub() method.</p>
<p>The optional count argument is the exact number of replacements to make in the input string, and if this is value is less than or equal to zero, then every match in the string is replaced.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">replacedString = re.sub(pattern, replacement_pattern, input_str, count, flags=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># Lets try and reverse the order of the day and month in a date </span></div><div class="line"><span class="comment"># string. Notice how the replacement string also contains metacharacters</span></div><div class="line"><span class="comment"># (the back references to the captured groups) so we use a raw </span></div><div class="line"><span class="comment"># string for that as well.</span></div><div class="line">regex = <span class="string">r"([a-zA-Z]+) (\d+)"</span></div><div class="line"></div><div class="line"><span class="comment"># This will reorder the string and print:</span></div><div class="line"><span class="comment">#   24 of June, 9 of August, 12 of Dec</span></div><div class="line"><span class="keyword">print</span> re.sub(regex, <span class="string">r"\2 of \1"</span>, <span class="string">"June 24, August 9, Dec 12"</span>)</div></pre></td></tr></table></figure>
<h2 id="re-Flags"><a href="#re-Flags" class="headerlink" title="re Flags"></a>re Flags</h2><p>In the Python regular expression methods above, you will notice that each of them also take an optional flags argument. Most of the available flags are a convenience and can be written into the into the regular expression itself directly, but some can be useful in certain cases.</p>
<ul>
<li>re.IGNORECASE makes the pattern case insensitive so that it matches strings of different capitalizations</li>
<li>re.MULTILINE is necessary if your input string has newline characters (\n) and allows the start and end metacharacter (^ and $ respectively) to match at the beginning and end of each line instead of at the beginning and end of the whole input string</li>
<li>re.DOTALL allows the dot (.) metacharacter match all characters, including the newline character (\n)</li>
</ul>
<h2 id="Compiling-a-pattern-for-performance"><a href="#Compiling-a-pattern-for-performance" class="headerlink" title="Compiling a pattern for performance"></a>Compiling a pattern for performance</h2><p>In Python, creating a new regular expression pattern to match many strings can be slow, so it is recommended that you compile them if you need to be testing or extracting information from many input strings using the same expression. This method returns a <code>re.RegexObject</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">regexObject = re.compile(pattern, flags=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<p>The returned object has exactly the same methods as above, except that they take the input string and no longer require the pattern or flags for each call.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># Lets create a pattern and extract some information with it</span></div><div class="line">regex = re.compile(<span class="string">r"(\w+) World"</span>)</div><div class="line">result = regex.search(<span class="string">"Hello World is the easiest"</span>)</div><div class="line"><span class="keyword">if</span> result:</div><div class="line">    <span class="comment"># This will print:</span></div><div class="line">    <span class="comment">#   0 11</span></div><div class="line">    <span class="comment"># for the start and end of the match</span></div><div class="line">    <span class="keyword">print</span> result.start(), result.end()</div><div class="line"></div><div class="line"><span class="comment"># This will print:</span></div><div class="line"><span class="comment">#   Hello</span></div><div class="line"><span class="comment">#   Bonjour</span></div><div class="line"><span class="comment"># for each of the captured groups that matched</span></div><div class="line"><span class="keyword">for</span> result <span class="keyword">in</span> regex.findall(<span class="string">"Hello World, Bonjour World"</span>):</div><div class="line">    <span class="keyword">print</span> result</div><div class="line"></div><div class="line"><span class="comment"># This will substitute "World" with "Earth" and print:</span></div><div class="line"><span class="comment">#   Hello Earth</span></div><div class="line"><span class="keyword">print</span> regex.sub(<span class="string">r"\1 Earth"</span>, <span class="string">"Hello World"</span>)</div></pre></td></tr></table></figure>
<p>一个方便的工具, 可以在线测试您写的相关语句:<br><a href="https://regex101.com/#python" target="_blank" rel="external">https://regex101.com/#python</a></p>
<h1 id="尾巴"><a href="#尾巴" class="headerlink" title="尾巴"></a>尾巴</h1><p>本文已经做了相当多的介绍和演示, 在python2.7中具体使用了regex.<br>如果上面的介绍还是不够, 下面也给出了更多的参考(可以参考官方文档):</p>
<ol>
<li><a href="">《Python Document》</a></li>
<li><a href="">《Python Compatible Regex Tester》</a></li>
</ol>
<hr>
<p>who is sponsoring the site? - i shall say merlin (<code>wizardmerlin945@gmail.com</code>)<br>欢迎发邮件给我(生活问题，请高抬贵手)</p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2017/05/14/shell-coding-style.html" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2017/05/12/using-regex-in-java.html" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2017-05-12 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/codings/">codings<span>26</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/regex/">regex<span>4</span></a></li> <li><a href="/tags/python/">python<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#引子"><span class="toc-article-text">引子</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#正文"><span class="toc-article-text">正文</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Raw-Python-strings"><span class="toc-article-text">Raw Python strings</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Matching-a-string"><span class="toc-article-text">Matching a string</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Capturing-groups"><span class="toc-article-text">Capturing groups</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Finding-and-replacing-strings"><span class="toc-article-text">Finding and replacing strings</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#re-Flags"><span class="toc-article-text">re Flags</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Compiling-a-pattern-for-performance"><span class="toc-article-text">Compiling a pattern for performance</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#尾巴"><span class="toc-article-text">尾巴</span></a></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2017 MerlinYu
  
     
     <br> Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind.386</a>.    
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
